[36m(TaskRunner pid=3147479)[0m {'actor_rollout_ref': {'actor': {'checkpoint': {'contents': ['model',
[36m(TaskRunner pid=3147479)[0m                                                              'optimizer',
[36m(TaskRunner pid=3147479)[0m                                                              'extra']},
[36m(TaskRunner pid=3147479)[0m                                  'clip_ratio': 0.2,
[36m(TaskRunner pid=3147479)[0m                                  'clip_ratio_c': 3.0,
[36m(TaskRunner pid=3147479)[0m                                  'clip_ratio_high': 0.2,
[36m(TaskRunner pid=3147479)[0m                                  'clip_ratio_low': 0.2,
[36m(TaskRunner pid=3147479)[0m                                  'entropy_coeff': 0,
[36m(TaskRunner pid=3147479)[0m                                  'fsdp_config': {'fsdp_size': -1,
[36m(TaskRunner pid=3147479)[0m                                                  'optimizer_offload': False,
[36m(TaskRunner pid=3147479)[0m                                                  'param_offload': False,
[36m(TaskRunner pid=3147479)[0m                                                  'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=3147479)[0m                                  'grad_clip': 1.0,
[36m(TaskRunner pid=3147479)[0m                                  'kl_loss_coef': 0.001,
[36m(TaskRunner pid=3147479)[0m                                  'kl_loss_type': 'low_var_kl',
[36m(TaskRunner pid=3147479)[0m                                  'loss_agg_mode': 'token-mean',
[36m(TaskRunner pid=3147479)[0m                                  'optim': {'lr': 1e-06,
[36m(TaskRunner pid=3147479)[0m                                            'lr_warmup_steps': -1,
[36m(TaskRunner pid=3147479)[0m                                            'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=3147479)[0m                                            'min_lr_ratio': None,
[36m(TaskRunner pid=3147479)[0m                                            'total_training_steps': -1,
[36m(TaskRunner pid=3147479)[0m                                            'warmup_style': 'constant',
[36m(TaskRunner pid=3147479)[0m                                            'weight_decay': 0.01},
[36m(TaskRunner pid=3147479)[0m                                  'ppo_epochs': 1,
[36m(TaskRunner pid=3147479)[0m                                  'ppo_max_token_len_per_gpu': 12000,
[36m(TaskRunner pid=3147479)[0m                                  'ppo_micro_batch_size': None,
[36m(TaskRunner pid=3147479)[0m                                  'ppo_micro_batch_size_per_gpu': 1,
[36m(TaskRunner pid=3147479)[0m                                  'ppo_mini_batch_size': 64,
[36m(TaskRunner pid=3147479)[0m                                  'shuffle': False,
[36m(TaskRunner pid=3147479)[0m                                  'strategy': 'fsdp',
[36m(TaskRunner pid=3147479)[0m                                  'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=3147479)[0m                                  'use_dynamic_bsz': True,
[36m(TaskRunner pid=3147479)[0m                                  'use_kl_loss': True,
[36m(TaskRunner pid=3147479)[0m                                  'use_torch_compile': True},
[36m(TaskRunner pid=3147479)[0m                        'hybrid_engine': True,
[36m(TaskRunner pid=3147479)[0m                        'model': {'dtype': 'bfloat16',
[36m(TaskRunner pid=3147479)[0m                                  'enable_gradient_checkpointing': True,
[36m(TaskRunner pid=3147479)[0m                                  'external_lib': None,
[36m(TaskRunner pid=3147479)[0m                                  'override_config': {},
[36m(TaskRunner pid=3147479)[0m                                  'path': 'Qwen/Qwen2-7B-Instruct',
[36m(TaskRunner pid=3147479)[0m                                  'use_liger': False,
[36m(TaskRunner pid=3147479)[0m                                  'use_remove_padding': True},
[36m(TaskRunner pid=3147479)[0m                        'ref': {'fsdp_config': {'param_offload': False,
[36m(TaskRunner pid=3147479)[0m                                                'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=3147479)[0m                                'log_prob_max_token_len_per_gpu': 12000,
[36m(TaskRunner pid=3147479)[0m                                'log_prob_micro_batch_size': None,
[36m(TaskRunner pid=3147479)[0m                                'log_prob_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=3147479)[0m                                'log_prob_use_dynamic_bsz': True,
[36m(TaskRunner pid=3147479)[0m                                'strategy': 'fsdp',
[36m(TaskRunner pid=3147479)[0m                                'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=3147479)[0m                                'use_torch_compile': True},
[36m(TaskRunner pid=3147479)[0m                        'rollout': {'chat_scheduler': None,
[36m(TaskRunner pid=3147479)[0m                                    'disable_log_stats': True,
[36m(TaskRunner pid=3147479)[0m                                    'do_sample': True,
[36m(TaskRunner pid=3147479)[0m                                    'dtype': 'bfloat16',
[36m(TaskRunner pid=3147479)[0m                                    'enable_chunked_prefill': True,
[36m(TaskRunner pid=3147479)[0m                                    'enforce_eager': True,
[36m(TaskRunner pid=3147479)[0m                                    'engine_kwargs': {'swap_space': None},
[36m(TaskRunner pid=3147479)[0m                                    'free_cache_engine': True,
[36m(TaskRunner pid=3147479)[0m                                    'gpu_memory_utilization': 0.6,
[36m(TaskRunner pid=3147479)[0m                                    'ignore_eos': False,
[36m(TaskRunner pid=3147479)[0m                                    'load_format': 'dummy_dtensor',
[36m(TaskRunner pid=3147479)[0m                                    'log_prob_max_token_len_per_gpu': 12000,
[36m(TaskRunner pid=3147479)[0m                                    'log_prob_micro_batch_size': None,
[36m(TaskRunner pid=3147479)[0m                                    'log_prob_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=3147479)[0m                                    'log_prob_use_dynamic_bsz': True,
[36m(TaskRunner pid=3147479)[0m                                    'max_model_len': None,
[36m(TaskRunner pid=3147479)[0m                                    'max_num_batched_tokens': 8192,
[36m(TaskRunner pid=3147479)[0m                                    'max_num_seqs': 1024,
[36m(TaskRunner pid=3147479)[0m                                    'mode': 'sync',
[36m(TaskRunner pid=3147479)[0m                                    'multi_turn': {'enable': False,
[36m(TaskRunner pid=3147479)[0m                                                   'format': 'chatml',
[36m(TaskRunner pid=3147479)[0m                                                   'max_turns': None,
[36m(TaskRunner pid=3147479)[0m                                                   'tool_config_path': None},
[36m(TaskRunner pid=3147479)[0m                                    'n': 5,
[36m(TaskRunner pid=3147479)[0m                                    'name': 'vllm',
[36m(TaskRunner pid=3147479)[0m                                    'prompt_length': 512,
[36m(TaskRunner pid=3147479)[0m                                    'response_length': 1024,
[36m(TaskRunner pid=3147479)[0m                                    'temperature': 1.0,
[36m(TaskRunner pid=3147479)[0m                                    'tensor_model_parallel_size': 2,
[36m(TaskRunner pid=3147479)[0m                                    'top_k': -1,
[36m(TaskRunner pid=3147479)[0m                                    'top_p': 1,
[36m(TaskRunner pid=3147479)[0m                                    'use_fire_sampling': False,
[36m(TaskRunner pid=3147479)[0m                                    'val_kwargs': {'do_sample': False,
[36m(TaskRunner pid=3147479)[0m                                                   'n': 1,
[36m(TaskRunner pid=3147479)[0m                                                   'temperature': 0,
[36m(TaskRunner pid=3147479)[0m                                                   'top_k': -1,
[36m(TaskRunner pid=3147479)[0m                                                   'top_p': 1.0}}},
[36m(TaskRunner pid=3147479)[0m  'algorithm': {'adv_estimator': 'gae',
[36m(TaskRunner pid=3147479)[0m                'gamma': 1.0,
[36m(TaskRunner pid=3147479)[0m                'kl_ctrl': {'horizon': 10000,
[36m(TaskRunner pid=3147479)[0m                            'kl_coef': 0.001,
[36m(TaskRunner pid=3147479)[0m                            'target_kl': 0.1,
[36m(TaskRunner pid=3147479)[0m                            'type': 'fixed'},
[36m(TaskRunner pid=3147479)[0m                'kl_penalty': 'kl',
[36m(TaskRunner pid=3147479)[0m                'lam': 1.0,
[36m(TaskRunner pid=3147479)[0m                'norm_adv_by_std_in_grpo': True,
[36m(TaskRunner pid=3147479)[0m                'use_kl_in_reward': False},
[36m(TaskRunner pid=3147479)[0m  'critic': {'checkpoint': {'contents': ['model', 'optimizer', 'extra']},
[36m(TaskRunner pid=3147479)[0m             'cliprange_value': 0.5,
[36m(TaskRunner pid=3147479)[0m             'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=3147479)[0m             'forward_micro_batch_size': None,
[36m(TaskRunner pid=3147479)[0m             'forward_micro_batch_size_per_gpu': 1,
[36m(TaskRunner pid=3147479)[0m             'grad_clip': 1.0,
[36m(TaskRunner pid=3147479)[0m             'model': {'enable_gradient_checkpointing': True,
[36m(TaskRunner pid=3147479)[0m                       'external_lib': None,
[36m(TaskRunner pid=3147479)[0m                       'fsdp_config': {'fsdp_size': -1,
[36m(TaskRunner pid=3147479)[0m                                       'optimizer_offload': False,
[36m(TaskRunner pid=3147479)[0m                                       'param_offload': False,
[36m(TaskRunner pid=3147479)[0m                                       'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=3147479)[0m                       'override_config': {},
[36m(TaskRunner pid=3147479)[0m                       'path': 'Qwen/Qwen2-7B-Instruct',
[36m(TaskRunner pid=3147479)[0m                       'tokenizer_path': 'Qwen/Qwen2-7B-Instruct',
[36m(TaskRunner pid=3147479)[0m                       'use_remove_padding': False},
[36m(TaskRunner pid=3147479)[0m             'optim': {'lr': 1e-05,
[36m(TaskRunner pid=3147479)[0m                       'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=3147479)[0m                       'min_lr_ratio': None,
[36m(TaskRunner pid=3147479)[0m                       'total_training_steps': -1,
[36m(TaskRunner pid=3147479)[0m                       'warmup_style': 'constant',
[36m(TaskRunner pid=3147479)[0m                       'weight_decay': 0.01},
[36m(TaskRunner pid=3147479)[0m             'ppo_epochs': 1,
[36m(TaskRunner pid=3147479)[0m             'ppo_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=3147479)[0m             'ppo_micro_batch_size': None,
[36m(TaskRunner pid=3147479)[0m             'ppo_micro_batch_size_per_gpu': 1,
[36m(TaskRunner pid=3147479)[0m             'ppo_mini_batch_size': 64,
[36m(TaskRunner pid=3147479)[0m             'rollout_n': 5,
[36m(TaskRunner pid=3147479)[0m             'shuffle': False,
[36m(TaskRunner pid=3147479)[0m             'strategy': 'fsdp',
[36m(TaskRunner pid=3147479)[0m             'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=3147479)[0m             'use_dynamic_bsz': True},
[36m(TaskRunner pid=3147479)[0m  'custom_reward_function': {'name': 'compute_score', 'path': None},
[36m(TaskRunner pid=3147479)[0m  'data': {'custom_cls': {'name': None, 'path': None},
[36m(TaskRunner pid=3147479)[0m           'filter_overlong_prompts': False,
[36m(TaskRunner pid=3147479)[0m           'filter_overlong_prompts_workers': 1,
[36m(TaskRunner pid=3147479)[0m           'image_key': 'images',
[36m(TaskRunner pid=3147479)[0m           'max_prompt_length': 512,
[36m(TaskRunner pid=3147479)[0m           'max_response_length': 1024,
[36m(TaskRunner pid=3147479)[0m           'prompt_key': 'prompt',
[36m(TaskRunner pid=3147479)[0m           'return_raw_chat': False,
[36m(TaskRunner pid=3147479)[0m           'return_raw_input_ids': False,
[36m(TaskRunner pid=3147479)[0m           'reward_fn_key': 'data_source',
[36m(TaskRunner pid=3147479)[0m           'shuffle': True,
[36m(TaskRunner pid=3147479)[0m           'tokenizer': None,
[36m(TaskRunner pid=3147479)[0m           'train_batch_size': 1024,
[36m(TaskRunner pid=3147479)[0m           'train_files': '/global/home/users/dingxianzhong/data/gsm8k/train.parquet',
[36m(TaskRunner pid=3147479)[0m           'truncation': 'error',
[36m(TaskRunner pid=3147479)[0m           'val_batch_size': 1312,
[36m(TaskRunner pid=3147479)[0m           'val_files': '/global/home/users/dingxianzhong/data/gsm8k/test.parquet',
[36m(TaskRunner pid=3147479)[0m           'video_key': 'videos'},
[36m(TaskRunner pid=3147479)[0m  'ray_init': {'num_cpus': None},
[36m(TaskRunner pid=3147479)[0m  'reward_model': {'enable': False,
[36m(TaskRunner pid=3147479)[0m                   'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=3147479)[0m                   'launch_reward_fn_async': False,
[36m(TaskRunner pid=3147479)[0m                   'max_length': None,
[36m(TaskRunner pid=3147479)[0m                   'micro_batch_size': None,
[36m(TaskRunner pid=3147479)[0m                   'micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=3147479)[0m                   'model': {'external_lib': None,
[36m(TaskRunner pid=3147479)[0m                             'fsdp_config': {'fsdp_size': -1,
[36m(TaskRunner pid=3147479)[0m                                             'param_offload': False,
[36m(TaskRunner pid=3147479)[0m                                             'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=3147479)[0m                             'input_tokenizer': 'Qwen/Qwen2-7B-Instruct',
[36m(TaskRunner pid=3147479)[0m                             'path': '~/models/FsfairX-LLaMA3-RM-v0.1',
[36m(TaskRunner pid=3147479)[0m                             'use_remove_padding': False},
[36m(TaskRunner pid=3147479)[0m                   'reward_manager': 'naive',
[36m(TaskRunner pid=3147479)[0m                   'strategy': 'fsdp',
[36m(TaskRunner pid=3147479)[0m                   'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=3147479)[0m                   'use_dynamic_bsz': True},
[36m(TaskRunner pid=3147479)[0m  'trainer': {'balance_batch': True,
[36m(TaskRunner pid=3147479)[0m              'critic_warmup': 0,
[36m(TaskRunner pid=3147479)[0m              'default_hdfs_dir': None,
[36m(TaskRunner pid=3147479)[0m              'default_local_dir': 'checkpoints/verl_qwen2_7b_gsm8k/ppo_qwen2_7b_recommended',
[36m(TaskRunner pid=3147479)[0m              'del_local_ckpt_after_load': False,
[36m(TaskRunner pid=3147479)[0m              'experiment_name': 'ppo_qwen2_7b_recommended',
[36m(TaskRunner pid=3147479)[0m              'log_val_generations': 0,
[36m(TaskRunner pid=3147479)[0m              'logger': ['console', 'wandb'],
[36m(TaskRunner pid=3147479)[0m              'max_actor_ckpt_to_keep': None,
[36m(TaskRunner pid=3147479)[0m              'max_critic_ckpt_to_keep': None,
[36m(TaskRunner pid=3147479)[0m              'n_gpus_per_node': 8,
[36m(TaskRunner pid=3147479)[0m              'nnodes': 1,
[36m(TaskRunner pid=3147479)[0m              'project_name': 'verl_qwen2_7b_gsm8k',
[36m(TaskRunner pid=3147479)[0m              'ray_wait_register_center_timeout': 300,
[36m(TaskRunner pid=3147479)[0m              'resume_from_path': None,
[36m(TaskRunner pid=3147479)[0m              'resume_mode': 'auto',
[36m(TaskRunner pid=3147479)[0m              'rollout_data_dir': None,
[36m(TaskRunner pid=3147479)[0m              'save_freq': -1,
[36m(TaskRunner pid=3147479)[0m              'test_freq': 5,
[36m(TaskRunner pid=3147479)[0m              'total_epochs': 10,
[36m(TaskRunner pid=3147479)[0m              'total_training_steps': None,
[36m(TaskRunner pid=3147479)[0m              'val_before_train': False,
[36m(TaskRunner pid=3147479)[0m              'validation_data_dir': None}}
[36m(TaskRunner pid=3147479)[0m WARNING: val_batch_size is deprecated. Validation datasets are sent to inference engines as a whole batch, which will schedule the memory themselves.
[36m(TaskRunner pid=3147479)[0m [validate_config] All configuration checks passed successfully!
[36m(TaskRunner pid=3147479)[0m Using default dataset class: RLHFDataset
[36m(TaskRunner pid=3147479)[0m dataset len: 7473
[36m(TaskRunner pid=3147479)[0m dataset len: 1319
[36m(TaskRunner pid=3147479)[0m Size of train dataloader: 7, Size of val dataloader: 2
[36m(TaskRunner pid=3147479)[0m Total training steps: 70
[36m(TaskRunner pid=3147479)[0m colocated worker base class <class 'verl.single_controller.base.worker.Worker'>
[36m(WorkerDict pid=3148081)[0m Critic overriding config {'bos_token_id': None, 'eos_token_id': 151645, 'pad_token_id': 151643}
[36m(WorkerDict pid=3148081)[0m Qwen2ForTokenClassification contains 7.07B parameters
[36m(WorkerDict pid=3148081)[0m Before critic FSDP, memory allocated (GB): 0.00, memory reserved (GB): 0.00, device memory used/total (GB): 0.51/79.33
[36m(WorkerDict pid=3148081)[0m NCCL version 2.21.5+cuda12.4
[36m(WorkerDict pid=3148304)[0m Total steps: 70, num_warmup_steps: 0
[36m(WorkerDict pid=3148304)[0m Critic use_remove_padding=False
[36m(WorkerDict pid=3148081)[0m After critic FSDP, memory allocated (GB): 3.32, memory reserved (GB): 11.27, device memory used/total (GB): 14.59/79.33
[36m(WorkerDict pid=3148081)[0m Model config after override: Qwen2Config {
[36m(WorkerDict pid=3148081)[0m   "architectures": [
[36m(WorkerDict pid=3148081)[0m     "Qwen2ForCausalLM"
[36m(WorkerDict pid=3148081)[0m   ],
[36m(WorkerDict pid=3148081)[0m   "attention_dropout": 0.0,
[36m(WorkerDict pid=3148081)[0m   "eos_token_id": 151645,
[36m(WorkerDict pid=3148081)[0m   "hidden_act": "silu",
[36m(WorkerDict pid=3148081)[0m   "hidden_size": 3584,
[36m(WorkerDict pid=3148081)[0m   "initializer_range": 0.02,
[36m(WorkerDict pid=3148081)[0m   "intermediate_size": 18944,
[36m(WorkerDict pid=3148081)[0m   "max_position_embeddings": 32768,
[36m(WorkerDict pid=3148081)[0m   "max_window_layers": 28,
[36m(WorkerDict pid=3148081)[0m   "model_type": "qwen2",
[36m(WorkerDict pid=3148081)[0m   "num_attention_heads": 28,
[36m(WorkerDict pid=3148081)[0m   "num_hidden_layers": 28,
[36m(WorkerDict pid=3148081)[0m   "num_key_value_heads": 4,
[36m(WorkerDict pid=3148081)[0m   "pad_token_id": 151643,
[36m(WorkerDict pid=3148081)[0m   "rms_norm_eps": 1e-06,
[36m(WorkerDict pid=3148081)[0m   "rope_scaling": null,
[36m(WorkerDict pid=3148081)[0m   "rope_theta": 1000000.0,
[36m(WorkerDict pid=3148081)[0m   "sliding_window": 131072,
[36m(WorkerDict pid=3148081)[0m   "tie_word_embeddings": false,
[36m(WorkerDict pid=3148081)[0m   "torch_dtype": "bfloat16",
[36m(WorkerDict pid=3148081)[0m   "transformers_version": "4.51.1",
[36m(WorkerDict pid=3148081)[0m   "use_cache": true,
[36m(WorkerDict pid=3148081)[0m   "use_sliding_window": false,
[36m(WorkerDict pid=3148081)[0m   "vocab_size": 152064
[36m(WorkerDict pid=3148081)[0m }
[36m(WorkerDict pid=3148081)[0m 
[36m(WorkerDict pid=3148081)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention
[36m(WorkerDict pid=3148081)[0m Qwen2ForCausalLM contains 7.62B parameters
[36m(WorkerDict pid=3148081)[0m wrap_policy: functools.partial(<function _or_policy at 0x14e851ed1cf0>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x14e851ed1bd0>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])
[36m(WorkerDict pid=3148081)[0m Actor use_remove_padding=True
[36m(WorkerDict pid=3148081)[0m Model config after override: Qwen2Config {
[36m(WorkerDict pid=3148081)[0m   "architectures": [
[36m(WorkerDict pid=3148081)[0m     "Qwen2ForCausalLM"
[36m(WorkerDict pid=3148081)[0m   ],
[36m(WorkerDict pid=3148081)[0m   "attention_dropout": 0.0,
[36m(WorkerDict pid=3148081)[0m   "eos_token_id": 151645,
[36m(WorkerDict pid=3148081)[0m   "hidden_act": "silu",
[36m(WorkerDict pid=3148081)[0m   "hidden_size": 3584,
[36m(WorkerDict pid=3148081)[0m   "initializer_range": 0.02,
[36m(WorkerDict pid=3148081)[0m   "intermediate_size": 18944,
[36m(WorkerDict pid=3148081)[0m   "max_position_embeddings": 32768,
[36m(WorkerDict pid=3148081)[0m   "max_window_layers": 28,
[36m(WorkerDict pid=3148081)[0m   "model_type": "qwen2",
[36m(WorkerDict pid=3148081)[0m   "num_attention_heads": 28,
[36m(WorkerDict pid=3148081)[0m   "num_hidden_layers": 28,
[36m(WorkerDict pid=3148081)[0m   "num_key_value_heads": 4,
[36m(WorkerDict pid=3148081)[0m   "pad_token_id": 151643,
[36m(WorkerDict pid=3148081)[0m   "rms_norm_eps": 1e-06,
[36m(WorkerDict pid=3148081)[0m   "rope_scaling": null,
[36m(WorkerDict pid=3148081)[0m   "rope_theta": 1000000.0,
[36m(WorkerDict pid=3148081)[0m   "sliding_window": 131072,
[36m(WorkerDict pid=3148081)[0m   "tie_word_embeddings": false,
[36m(WorkerDict pid=3148081)[0m   "torch_dtype": "bfloat16",
[36m(WorkerDict pid=3148081)[0m   "transformers_version": "4.51.1",
[36m(WorkerDict pid=3148081)[0m   "use_cache": true,
[36m(WorkerDict pid=3148081)[0m   "use_sliding_window": false,
[36m(WorkerDict pid=3148081)[0m   "vocab_size": 152064
[36m(WorkerDict pid=3148081)[0m }
[36m(WorkerDict pid=3148081)[0m 
[36m(WorkerDict pid=3148308)[0m Total steps: 70, num_warmup_steps: 0[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3148308)[0m Critic use_remove_padding=False[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3148303)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3148308)[0m wrap_policy: functools.partial(<function _or_policy at 0x14e822ab9cf0>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x14e822ab9bd0>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3148308)[0m Actor use_remove_padding=True[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3148306)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention
[36m(WorkerDict pid=3148305)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention
[36m(WorkerDict pid=3148081)[0m Qwen2ForCausalLM contains 7.62B parameters
[36m(WorkerDict pid=3148081)[0m wrap_policy: functools.partial(<function _or_policy at 0x14e851ed1cf0>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x14e851ed1bd0>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])
[36m(WorkerDict pid=3148304)[0m Total steps: 70, num_warmup_steps: 0
[36m(WorkerDict pid=3148081)[0m WARNING 05-03 11:30:37 [cuda.py:96] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used
[36m(WorkerDict pid=3148081)[0m Actor use_remove_padding=True[32m [repeated 8x across cluster][0m
[36m(WorkerDict pid=3148307)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention[32m [repeated 6x across cluster][0m
[36m(WorkerDict pid=3148308)[0m wrap_policy: functools.partial(<function _or_policy at 0x14e822ab9cf0>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x14e822ab9bd0>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3148081)[0m Total steps: 70, num_warmup_steps: 0[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3148081)[0m WARNING 05-03 11:30:37 [utils.py:2413] Methods determine_num_available_blocks,device_config,get_cache_block_size_bytes,initialize_cache not implemented in <vllm.v1.worker.gpu_worker.Worker object at 0x14e4b64d6290>
[36m(WorkerDict pid=3148303)[0m NCCL version 2.21.5+cuda12.4
[36m(WorkerDict pid=3148302)[0m kwargs: {'n': 5, 'logprobs': 0, 'max_tokens': 1024, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 1, 'ignore_eos': False}
[36m(WorkerDict pid=3148307)[0m WARNING 05-03 11:30:37 [cuda.py:96] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3148306)[0m WARNING 05-03 11:30:38 [utils.py:2413] Methods determine_num_available_blocks,device_config,get_cache_block_size_bytes,initialize_cache not implemented in <vllm.v1.worker.gpu_worker.Worker object at 0x14e62c0e22f0>[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3148305)[0m NCCL version 2.21.5+cuda12.4[32m [repeated 2x across cluster][0m
[36m(TaskRunner pid=3147479)[0m Using LocalLogger is deprecated. The constructor API will change 
[36m(TaskRunner pid=3147479)[0m Checkpoint tracker file does not exist: %s /global/scratch/users/dingxianzhong/verl/checkpoints/verl_qwen2_7b_gsm8k/ppo_qwen2_7b_recommended/latest_checkpointed_iteration.txt
[36m(TaskRunner pid=3147479)[0m Training from scratch
[36m(WorkerDict pid=3148306)[0m kwargs: {'n': 5, 'logprobs': 0, 'max_tokens': 1024, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 1, 'ignore_eos': False}[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:1 - global_seqlen/min:182181.000 - global_seqlen/max:191198.000 - global_seqlen/minmax_diff:9017.000 - global_seqlen/balanced_min:186416.000 - global_seqlen/balanced_max:186417.000 - global_seqlen/mean:186416.875 - actor/entropy_loss:0.241 - critic/vf_loss:7.836 - critic/vf_clipfrac:0.006 - critic/vpred_mean:-0.490 - critic/grad_norm:362.063 - perf/mfu/critic:0.087 - critic/lr:0.000 - actor/kl_loss:0.000 - actor/kl_coef:0.001 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.841 - perf/mfu/actor:0.256 - perf/max_memory_allocated_gb:76.467 - perf/max_memory_reserved_gb:105.680 - perf/cpu_memory_used_gb:49.424 - actor/lr:0.000 - training/global_step:1.000 - training/epoch:0.000 - critic/score/mean:0.257 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.257 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:5.532 - critic/advantages/min:-6.355 - critic/returns/mean:0.247 - critic/returns/max:1.000 - critic/returns/min:-0.000 - critic/values/mean:-0.338 - critic/values/max:21.000 - critic/values/min:-19.125 - critic/vf_explained_var:-60.955 - response_length/mean:196.849 - response_length/max:1024.000 - response_length/min:25.000 - response_length/clip_ratio:0.001 - prompt_length/mean:94.428 - prompt_length/max:205.000 - prompt_length/min:55.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:25.976 - timing_s/reward:0.730 - timing_s/old_log_prob:7.431 - timing_s/ref:9.790 - timing_s/values:27.900 - timing_s/adv:0.226 - timing_s/update_critic:99.580 - timing_s/update_actor:33.978 - timing_s/step:205.723 - timing_per_token_ms/values:0.019 - timing_per_token_ms/update_actor:0.023 - timing_per_token_ms/ref:0.007 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.026 - timing_per_token_ms/update_critic:0.067 - perf/total_num_tokens:1491335.000 - perf/time_per_step:205.723 - perf/throughput:906.153
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:2 - global_seqlen/min:177669.000 - global_seqlen/max:191144.000 - global_seqlen/minmax_diff:13475.000 - global_seqlen/balanced_min:186053.000 - global_seqlen/balanced_max:186053.000 - global_seqlen/mean:186053.000 - actor/entropy_loss:0.244 - critic/vf_loss:13.653 - critic/vf_clipfrac:0.301 - critic/vpred_mean:1.354 - critic/grad_norm:823.773 - perf/mfu/critic:0.088 - critic/lr:0.000 - actor/kl_loss:0.001 - actor/kl_coef:0.001 - actor/pg_loss:0.005 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.776 - perf/mfu/actor:0.265 - perf/max_memory_allocated_gb:83.560 - perf/max_memory_reserved_gb:105.680 - perf/cpu_memory_used_gb:49.623 - actor/lr:0.000 - training/global_step:2.000 - training/epoch:0.000 - critic/score/mean:0.265 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.265 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.000 - critic/advantages/max:5.190 - critic/advantages/min:-5.853 - critic/returns/mean:0.260 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:-0.307 - critic/values/max:19.375 - critic/values/min:-18.000 - critic/vf_explained_var:-59.344 - response_length/mean:198.174 - response_length/max:1024.000 - response_length/min:29.000 - response_length/clip_ratio:0.001 - prompt_length/mean:92.534 - prompt_length/max:246.000 - prompt_length/min:53.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:27.187 - timing_s/reward:0.706 - timing_s/old_log_prob:6.692 - timing_s/ref:6.519 - timing_s/values:27.357 - timing_s/adv:0.221 - timing_s/update_critic:99.165 - timing_s/update_actor:32.880 - timing_s/step:200.813 - timing_per_token_ms/values:0.018 - timing_per_token_ms/update_actor:0.022 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.027 - timing_per_token_ms/update_critic:0.067 - perf/total_num_tokens:1488424.000 - perf/time_per_step:200.813 - perf/throughput:926.501
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:3 - global_seqlen/min:184079.000 - global_seqlen/max:192207.000 - global_seqlen/minmax_diff:8128.000 - global_seqlen/balanced_min:188259.000 - global_seqlen/balanced_max:188260.000 - global_seqlen/mean:188259.750 - actor/entropy_loss:0.245 - critic/vf_loss:0.895 - critic/vf_clipfrac:0.465 - critic/vpred_mean:0.634 - critic/grad_norm:123.923 - perf/mfu/critic:0.089 - critic/lr:0.000 - actor/kl_loss:0.001 - actor/kl_coef:0.001 - actor/pg_loss:-0.006 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.742 - perf/mfu/actor:0.256 - perf/max_memory_allocated_gb:83.563 - perf/max_memory_reserved_gb:105.885 - perf/cpu_memory_used_gb:49.807 - actor/lr:0.000 - training/global_step:3.000 - training/epoch:0.000 - critic/score/mean:0.314 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.314 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:6.377 - critic/advantages/min:-4.872 - critic/returns/mean:0.308 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:1.484 - critic/values/max:5.938 - critic/values/min:-4.062 - critic/vf_explained_var:-3.483 - response_length/mean:200.461 - response_length/max:1024.000 - response_length/min:34.000 - response_length/clip_ratio:0.001 - prompt_length/mean:93.695 - prompt_length/max:191.000 - prompt_length/min:58.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.911 - timing_s/reward:0.731 - timing_s/old_log_prob:6.683 - timing_s/ref:6.533 - timing_s/values:27.412 - timing_s/adv:0.213 - timing_s/update_critic:99.200 - timing_s/update_actor:34.411 - timing_s/step:202.181 - timing_per_token_ms/values:0.018 - timing_per_token_ms/update_actor:0.023 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.026 - timing_per_token_ms/update_critic:0.066 - perf/total_num_tokens:1506078.000 - perf/time_per_step:202.181 - perf/throughput:931.144
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:4 - global_seqlen/min:185849.000 - global_seqlen/max:191042.000 - global_seqlen/minmax_diff:5193.000 - global_seqlen/balanced_min:188270.000 - global_seqlen/balanced_max:188271.000 - global_seqlen/mean:188270.750 - actor/entropy_loss:0.252 - critic/vf_loss:0.208 - critic/vf_clipfrac:0.096 - critic/vpred_mean:0.431 - critic/grad_norm:64.276 - perf/mfu/critic:0.088 - critic/lr:0.000 - actor/kl_loss:0.008 - actor/kl_coef:0.001 - actor/pg_loss:-0.013 - actor/pg_clipfrac:0.007 - actor/ppo_kl:0.002 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.759 - perf/mfu/actor:0.272 - perf/max_memory_allocated_gb:83.563 - perf/max_memory_reserved_gb:106.184 - perf/cpu_memory_used_gb:49.771 - actor/lr:0.000 - training/global_step:4.000 - training/epoch:0.000 - critic/score/mean:0.431 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.431 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.000 - critic/advantages/max:2.645 - critic/advantages/min:-2.758 - critic/returns/mean:0.407 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.387 - critic/values/max:1.570 - critic/values/min:-0.570 - critic/vf_explained_var:-0.220 - response_length/mean:200.481 - response_length/max:1024.000 - response_length/min:37.000 - response_length/clip_ratio:0.001 - prompt_length/mean:93.692 - prompt_length/max:228.000 - prompt_length/min:46.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.508 - timing_s/reward:0.717 - timing_s/old_log_prob:6.773 - timing_s/ref:6.517 - timing_s/values:27.744 - timing_s/adv:0.211 - timing_s/update_critic:100.296 - timing_s/update_actor:32.410 - timing_s/step:201.261 - timing_per_token_ms/values:0.018 - timing_per_token_ms/update_actor:0.022 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.026 - timing_per_token_ms/update_critic:0.067 - perf/total_num_tokens:1506166.000 - perf/time_per_step:201.261 - perf/throughput:935.458
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=3147479)[0m validation generation end
[36m(TaskRunner pid=3147479)[0m [prompt] system
[36m(TaskRunner pid=3147479)[0m You are a helpful assistant.
[36m(TaskRunner pid=3147479)[0m user
[36m(TaskRunner pid=3147479)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=3147479)[0m assistant
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m [response] Janet's ducks lay 16 eggs per day. She eats 3 for breakfast and uses 4 for baking, which totals 3 + 4 = 7 eggs. 
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m So, she has 16 - 7 = 9 eggs left to sell at the farmers' market daily.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m Since she sells each egg for $2, she makes 9 * $2 = $18 every day at the farmers' market.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m #### $18
[36m(TaskRunner pid=3147479)[0m [ground_truth] 18
[36m(TaskRunner pid=3147479)[0m [score] 0.0
[36m(TaskRunner pid=3147479)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=3147479)[0m validation generation end
[36m(TaskRunner pid=3147479)[0m [prompt] system
[36m(TaskRunner pid=3147479)[0m You are a helpful assistant.
[36m(TaskRunner pid=3147479)[0m user
[36m(TaskRunner pid=3147479)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=3147479)[0m assistant
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m [response] First, let's calculate the total cost for one night's worth of meals and wine.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m Each night, Tom's restaurant gets 6 reservations. For each reservation, they order 2 meals at $5 each and a $5 bottle of wine. 
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m So, the cost per reservation is:
[36m(TaskRunner pid=3147479)[0m \[2 \times \$5 + \$5 = \$10 + \$5 = \$15\]
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m For 6 reservations, the total cost per night is:
[36m(TaskRunner pid=3147479)[0m \[6 \times \$15 = \$90\]
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m Since they are open 2 days a week, the total weekly cost is:
[36m(TaskRunner pid=3147479)[0m \[2 \times \$90 = \$180\]
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m Therefore, Tom's restaurant makes $180 a week. 
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m #### 180
[36m(TaskRunner pid=3147479)[0m [ground_truth] 180
[36m(TaskRunner pid=3147479)[0m [score] 1.0
[36m(TaskRunner pid=3147479)[0m step:5 - global_seqlen/min:181735.000 - global_seqlen/max:194603.000 - global_seqlen/minmax_diff:12868.000 - global_seqlen/balanced_min:190347.000 - global_seqlen/balanced_max:190347.000 - global_seqlen/mean:190347.000 - actor/entropy_loss:0.257 - critic/vf_loss:0.314 - critic/vf_clipfrac:0.090 - critic/vpred_mean:0.622 - critic/grad_norm:97.583 - perf/mfu/critic:0.089 - critic/lr:0.000 - actor/kl_loss:0.014 - actor/kl_coef:0.001 - actor/pg_loss:-0.012 - actor/pg_clipfrac:0.005 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.685 - perf/mfu/actor:0.274 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.221 - perf/cpu_memory_used_gb:49.814 - actor/lr:0.000 - val-core/openai/gsm8k/reward/mean@1:0.813 - val-aux/openai/gsm8k/reward/std@1:0.000 - val-core/openai/gsm8k/reward/best@1/mean:0.813 - val-aux/openai/gsm8k/reward/worst@1/mean:0.813 - training/global_step:5.000 - training/epoch:0.000 - critic/score/mean:0.660 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.660 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:1.864 - critic/advantages/min:-2.236 - critic/returns/mean:0.626 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.672 - critic/values/max:1.359 - critic/values/min:0.000 - critic/vf_explained_var:-0.341 - response_length/mean:203.012 - response_length/max:1024.000 - response_length/min:22.000 - response_length/clip_ratio:0.002 - prompt_length/mean:94.405 - prompt_length/max:201.000 - prompt_length/min:52.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:27.508 - timing_s/reward:0.726 - timing_s/old_log_prob:6.867 - timing_s/ref:6.597 - timing_s/values:27.309 - timing_s/adv:0.245 - timing_s/update_critic:100.291 - timing_s/update_actor:32.496 - timing_s/testing:23.021 - timing_s/step:225.142 - timing_per_token_ms/values:0.018 - timing_per_token_ms/update_actor:0.021 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.026 - timing_per_token_ms/update_critic:0.066 - perf/total_num_tokens:1522776.000 - perf/time_per_step:225.142 - perf/throughput:845.453
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:6 - global_seqlen/min:179531.000 - global_seqlen/max:187524.000 - global_seqlen/minmax_diff:7993.000 - global_seqlen/balanced_min:183215.000 - global_seqlen/balanced_max:183216.000 - global_seqlen/mean:183215.750 - actor/entropy_loss:0.262 - critic/vf_loss:0.185 - critic/vf_clipfrac:0.300 - critic/vpred_mean:0.826 - critic/grad_norm:56.291 - perf/mfu/critic:0.086 - critic/lr:0.000 - actor/kl_loss:0.016 - actor/kl_coef:0.001 - actor/pg_loss:0.041 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.765 - perf/mfu/actor:0.249 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.221 - perf/cpu_memory_used_gb:49.775 - actor/lr:0.000 - training/global_step:6.000 - training/epoch:0.000 - critic/score/mean:0.853 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.853 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.000 - critic/advantages/max:2.174 - critic/advantages/min:-3.374 - critic/returns/mean:0.820 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.156 - critic/values/max:0.676 - critic/values/min:-0.520 - critic/vf_explained_var:-0.049 - response_length/mean:193.303 - response_length/max:1024.000 - response_length/min:33.000 - response_length/clip_ratio:0.000 - prompt_length/mean:92.972 - prompt_length/max:207.000 - prompt_length/min:54.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:25.181 - timing_s/reward:0.731 - timing_s/old_log_prob:6.662 - timing_s/ref:6.417 - timing_s/values:27.396 - timing_s/adv:0.250 - timing_s/update_critic:98.999 - timing_s/update_actor:34.372 - timing_s/step:200.103 - timing_per_token_ms/values:0.019 - timing_per_token_ms/update_actor:0.023 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.025 - timing_per_token_ms/update_critic:0.068 - perf/total_num_tokens:1465726.000 - perf/time_per_step:200.103 - perf/throughput:915.608
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:7 - global_seqlen/min:177493.000 - global_seqlen/max:187079.000 - global_seqlen/minmax_diff:9586.000 - global_seqlen/balanced_min:183164.000 - global_seqlen/balanced_max:183165.000 - global_seqlen/mean:183164.375 - actor/entropy_loss:0.259 - critic/vf_loss:0.082 - critic/vf_clipfrac:0.144 - critic/vpred_mean:0.856 - critic/grad_norm:23.188 - perf/mfu/critic:0.085 - critic/lr:0.000 - actor/kl_loss:0.016 - actor/kl_coef:0.001 - actor/pg_loss:0.028 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.856 - perf/mfu/actor:0.246 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.221 - perf/cpu_memory_used_gb:49.894 - actor/lr:0.000 - training/global_step:7.000 - training/epoch:0.000 - critic/score/mean:0.906 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.906 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:5.204 - critic/advantages/min:-3.141 - critic/returns/mean:0.870 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.566 - critic/values/max:1.133 - critic/values/min:-1.570 - critic/vf_explained_var:-0.681 - response_length/mean:192.853 - response_length/max:1024.000 - response_length/min:33.000 - response_length/clip_ratio:0.001 - prompt_length/mean:93.342 - prompt_length/max:202.000 - prompt_length/min:55.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.961 - timing_s/reward:0.740 - timing_s/old_log_prob:6.635 - timing_s/ref:6.460 - timing_s/values:27.973 - timing_s/adv:0.227 - timing_s/update_critic:100.881 - timing_s/update_actor:34.713 - timing_s/step:204.678 - timing_per_token_ms/values:0.019 - timing_per_token_ms/update_actor:0.024 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.027 - timing_per_token_ms/update_critic:0.069 - perf/total_num_tokens:1465315.000 - perf/time_per_step:204.678 - perf/throughput:894.890
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:8 - global_seqlen/min:176335.000 - global_seqlen/max:190720.000 - global_seqlen/minmax_diff:14385.000 - global_seqlen/balanced_min:184553.000 - global_seqlen/balanced_max:184554.000 - global_seqlen/mean:184553.250 - actor/entropy_loss:0.252 - critic/vf_loss:0.072 - critic/vf_clipfrac:0.157 - critic/vpred_mean:0.793 - critic/grad_norm:20.142 - perf/mfu/critic:0.084 - critic/lr:0.000 - actor/kl_loss:0.016 - actor/kl_coef:0.001 - actor/pg_loss:-0.011 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.780 - perf/mfu/actor:0.257 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.221 - perf/cpu_memory_used_gb:50.806 - actor/lr:0.000 - training/global_step:8.000 - training/epoch:1.000 - critic/score/mean:0.926 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.926 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.000 - critic/advantages/max:1.623 - critic/advantages/min:-3.304 - critic/returns/mean:0.893 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.539 - critic/values/max:0.988 - critic/values/min:0.000 - critic/vf_explained_var:-0.660 - response_length/mean:194.993 - response_length/max:1024.000 - response_length/min:41.000 - response_length/clip_ratio:0.000 - prompt_length/mean:93.371 - prompt_length/max:196.000 - prompt_length/min:55.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:25.835 - timing_s/reward:0.737 - timing_s/old_log_prob:6.807 - timing_s/ref:6.497 - timing_s/values:27.250 - timing_s/adv:0.236 - timing_s/update_critic:102.247 - timing_s/update_actor:33.575 - timing_s/step:203.307 - timing_per_token_ms/values:0.018 - timing_per_token_ms/update_actor:0.023 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.026 - timing_per_token_ms/update_critic:0.069 - perf/total_num_tokens:1476426.000 - perf/time_per_step:203.307 - perf/throughput:907.757
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:9 - global_seqlen/min:176850.000 - global_seqlen/max:191222.000 - global_seqlen/minmax_diff:14372.000 - global_seqlen/balanced_min:183657.000 - global_seqlen/balanced_max:183658.000 - global_seqlen/mean:183657.625 - actor/entropy_loss:0.252 - critic/vf_loss:0.064 - critic/vf_clipfrac:0.163 - critic/vpred_mean:0.832 - critic/grad_norm:18.663 - perf/mfu/critic:0.087 - critic/lr:0.000 - actor/kl_loss:0.013 - actor/kl_coef:0.001 - actor/pg_loss:-0.030 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.866 - perf/mfu/actor:0.241 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.301 - perf/cpu_memory_used_gb:51.049 - actor/lr:0.000 - training/global_step:9.000 - training/epoch:1.000 - critic/score/mean:0.929 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.929 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:1.669 - critic/advantages/min:-3.092 - critic/returns/mean:0.887 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.551 - critic/values/max:0.973 - critic/values/min:0.000 - critic/vf_explained_var:-0.580 - response_length/mean:192.880 - response_length/max:1024.000 - response_length/min:34.000 - response_length/clip_ratio:0.001 - prompt_length/mean:94.085 - prompt_length/max:246.000 - prompt_length/min:46.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.230 - timing_s/reward:0.708 - timing_s/old_log_prob:6.535 - timing_s/ref:6.399 - timing_s/values:27.352 - timing_s/adv:0.232 - timing_s/update_critic:98.497 - timing_s/update_actor:35.628 - timing_s/step:201.898 - timing_per_token_ms/values:0.019 - timing_per_token_ms/update_actor:0.024 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.027 - timing_per_token_ms/update_critic:0.067 - perf/total_num_tokens:1469261.000 - perf/time_per_step:201.898 - perf/throughput:909.654
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=3147479)[0m validation generation end
[36m(TaskRunner pid=3147479)[0m [prompt] system
[36m(TaskRunner pid=3147479)[0m You are a helpful assistant.
[36m(TaskRunner pid=3147479)[0m user
[36m(TaskRunner pid=3147479)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=3147479)[0m assistant
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m [response] Janet's ducks lay 16 eggs per day. She eats 3 for breakfast and uses 4 for baking, which totals 3 + 4 = 7 eggs. 
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m So, the number of eggs left to sell is 16 - 7 = 9 eggs.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m She sells each egg for $2, so she makes 9 * $2 = $18 every day at the farmers' market.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m #### 18
[36m(TaskRunner pid=3147479)[0m [ground_truth] 18
[36m(TaskRunner pid=3147479)[0m [score] 1.0
[36m(TaskRunner pid=3147479)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=3147479)[0m validation generation end
[36m(TaskRunner pid=3147479)[0m [prompt] system
[36m(TaskRunner pid=3147479)[0m You are a helpful assistant.
[36m(TaskRunner pid=3147479)[0m user
[36m(TaskRunner pid=3147479)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=3147479)[0m assistant
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m [response] Tom's restaurant gets 6 reservations a night and is open 2 days a week, so they get \(6 \times 2 = 12\) reservations a week.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m For each reservation, they order 2 meals at $5 each, so that's \(2 \times 5 = 10\) dollars per reservation for meals. 
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m They also order a $5 bottle of wine per reservation, so that's an additional $5 per reservation.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m Therefore, for each reservation, they spend \(10 + 5 = 15\) dollars.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m Given they have 12 reservations a week, their total weekly expenditure is \(12 \times 15 = 180\) dollars.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m Since they are making $15 per reservation and have 12 reservations a week, they make \(12 \times 15 = 180\) dollars a week.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m #### 180
[36m(TaskRunner pid=3147479)[0m [ground_truth] 180
[36m(TaskRunner pid=3147479)[0m [score] 1.0
[36m(TaskRunner pid=3147479)[0m step:10 - global_seqlen/min:175049.000 - global_seqlen/max:187554.000 - global_seqlen/minmax_diff:12505.000 - global_seqlen/balanced_min:181990.000 - global_seqlen/balanced_max:181991.000 - global_seqlen/mean:181990.625 - actor/entropy_loss:0.242 - critic/vf_loss:0.065 - critic/vf_clipfrac:0.173 - critic/vpred_mean:0.877 - critic/grad_norm:19.859 - perf/mfu/critic:0.085 - critic/lr:0.000 - actor/kl_loss:0.014 - actor/kl_coef:0.001 - actor/pg_loss:0.011 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.796 - perf/mfu/actor:0.256 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.301 - perf/cpu_memory_used_gb:51.015 - actor/lr:0.000 - val-core/openai/gsm8k/reward/mean@1:0.872 - val-aux/openai/gsm8k/reward/std@1:0.000 - val-core/openai/gsm8k/reward/best@1/mean:0.872 - val-aux/openai/gsm8k/reward/worst@1/mean:0.872 - training/global_step:10.000 - training/epoch:1.000 - critic/score/mean:0.940 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.940 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:1.712 - critic/advantages/min:-3.168 - critic/returns/mean:0.911 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.605 - critic/values/max:1.109 - critic/values/min:0.000 - critic/vf_explained_var:-1.031 - response_length/mean:190.326 - response_length/max:1024.000 - response_length/min:35.000 - response_length/clip_ratio:0.000 - prompt_length/mean:94.034 - prompt_length/max:184.000 - prompt_length/min:55.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:28.130 - timing_s/reward:0.718 - timing_s/old_log_prob:6.567 - timing_s/ref:6.368 - timing_s/values:27.243 - timing_s/adv:0.220 - timing_s/update_critic:99.613 - timing_s/update_actor:33.262 - timing_s/testing:22.756 - timing_s/step:224.971 - timing_per_token_ms/values:0.019 - timing_per_token_ms/update_actor:0.023 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.029 - timing_per_token_ms/update_critic:0.068 - perf/total_num_tokens:1455925.000 - perf/time_per_step:224.971 - perf/throughput:808.951
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:11 - global_seqlen/min:172593.000 - global_seqlen/max:179031.000 - global_seqlen/minmax_diff:6438.000 - global_seqlen/balanced_min:175710.000 - global_seqlen/balanced_max:175711.000 - global_seqlen/mean:175710.875 - actor/entropy_loss:0.244 - critic/vf_loss:0.053 - critic/vf_clipfrac:0.191 - critic/vpred_mean:0.884 - critic/grad_norm:15.263 - perf/mfu/critic:0.084 - critic/lr:0.000 - actor/kl_loss:0.012 - actor/kl_coef:0.001 - actor/pg_loss:-0.041 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.750 - perf/mfu/actor:0.260 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.545 - perf/cpu_memory_used_gb:51.044 - actor/lr:0.000 - training/global_step:11.000 - training/epoch:1.000 - critic/score/mean:0.952 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.952 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.000 - critic/advantages/max:3.232 - critic/advantages/min:-3.225 - critic/returns/mean:0.931 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.629 - critic/values/max:1.094 - critic/values/min:-0.605 - critic/vf_explained_var:-1.523 - response_length/mean:181.327 - response_length/max:1024.000 - response_length/min:39.000 - response_length/clip_ratio:0.001 - prompt_length/mean:93.222 - prompt_length/max:222.000 - prompt_length/min:53.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:24.460 - timing_s/reward:0.689 - timing_s/old_log_prob:6.432 - timing_s/ref:6.120 - timing_s/values:27.965 - timing_s/adv:0.238 - timing_s/update_critic:97.189 - timing_s/update_actor:31.607 - timing_s/step:194.786 - timing_per_token_ms/values:0.020 - timing_per_token_ms/update_actor:0.022 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.026 - timing_per_token_ms/update_critic:0.069 - perf/total_num_tokens:1405687.000 - perf/time_per_step:194.786 - perf/throughput:902.073
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:12 - global_seqlen/min:170862.000 - global_seqlen/max:184406.000 - global_seqlen/minmax_diff:13544.000 - global_seqlen/balanced_min:178554.000 - global_seqlen/balanced_max:178555.000 - global_seqlen/mean:178554.625 - actor/entropy_loss:0.247 - critic/vf_loss:0.060 - critic/vf_clipfrac:0.189 - critic/vpred_mean:0.876 - critic/grad_norm:14.744 - perf/mfu/critic:0.085 - critic/lr:0.000 - actor/kl_loss:0.021 - actor/kl_coef:0.001 - actor/pg_loss:-0.012 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.649 - perf/mfu/actor:0.238 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.545 - perf/cpu_memory_used_gb:51.184 - actor/lr:0.000 - training/global_step:12.000 - training/epoch:1.000 - critic/score/mean:0.941 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.941 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.000 - critic/advantages/max:1.668 - critic/advantages/min:-3.079 - critic/returns/mean:0.910 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.609 - critic/values/max:1.031 - critic/values/min:0.000 - critic/vf_explained_var:-1.150 - response_length/mean:185.608 - response_length/max:1024.000 - response_length/min:36.000 - response_length/clip_ratio:0.000 - prompt_length/mean:93.384 - prompt_length/max:228.000 - prompt_length/min:54.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:24.366 - timing_s/reward:0.687 - timing_s/old_log_prob:6.485 - timing_s/ref:6.258 - timing_s/values:28.153 - timing_s/adv:0.232 - timing_s/update_critic:97.954 - timing_s/update_actor:35.080 - timing_s/step:199.308 - timing_per_token_ms/values:0.020 - timing_per_token_ms/update_actor:0.025 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.026 - timing_per_token_ms/update_critic:0.069 - perf/total_num_tokens:1428437.000 - perf/time_per_step:199.308 - perf/throughput:895.873
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:13 - global_seqlen/min:171135.000 - global_seqlen/max:182282.000 - global_seqlen/minmax_diff:11147.000 - global_seqlen/balanced_min:176488.000 - global_seqlen/balanced_max:176489.000 - global_seqlen/mean:176488.875 - actor/entropy_loss:0.243 - critic/vf_loss:0.060 - critic/vf_clipfrac:0.171 - critic/vpred_mean:0.875 - critic/grad_norm:14.725 - perf/mfu/critic:0.083 - critic/lr:0.000 - actor/kl_loss:0.020 - actor/kl_coef:0.001 - actor/pg_loss:0.046 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.784 - perf/mfu/actor:0.233 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.545 - perf/cpu_memory_used_gb:51.115 - actor/lr:0.000 - training/global_step:13.000 - training/epoch:1.000 - critic/score/mean:0.938 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.938 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:3.080 - critic/advantages/min:-3.114 - critic/returns/mean:0.904 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.621 - critic/values/max:1.430 - critic/values/min:-0.617 - critic/vf_explained_var:-1.032 - response_length/mean:182.751 - response_length/max:1024.000 - response_length/min:33.000 - response_length/clip_ratio:0.000 - prompt_length/mean:93.013 - prompt_length/max:206.000 - prompt_length/min:53.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.482 - timing_s/reward:0.694 - timing_s/old_log_prob:6.456 - timing_s/ref:6.169 - timing_s/values:27.280 - timing_s/adv:0.218 - timing_s/update_critic:98.723 - timing_s/update_actor:35.440 - timing_s/step:201.551 - timing_per_token_ms/values:0.019 - timing_per_token_ms/update_actor:0.025 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.028 - timing_per_token_ms/update_critic:0.070 - perf/total_num_tokens:1411911.000 - perf/time_per_step:201.551 - perf/throughput:875.655
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:14 - global_seqlen/min:170305.000 - global_seqlen/max:183634.000 - global_seqlen/minmax_diff:13329.000 - global_seqlen/balanced_min:177425.000 - global_seqlen/balanced_max:177441.000 - global_seqlen/mean:177433.000 - actor/entropy_loss:0.239 - critic/vf_loss:0.053 - critic/vf_clipfrac:0.194 - critic/vpred_mean:0.888 - critic/grad_norm:13.833 - perf/mfu/critic:0.082 - critic/lr:0.000 - actor/kl_loss:0.030 - actor/kl_coef:0.001 - actor/pg_loss:-0.012 - actor/pg_clipfrac:0.005 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.634 - perf/mfu/actor:0.261 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.545 - perf/cpu_memory_used_gb:51.246 - actor/lr:0.000 - training/global_step:14.000 - training/epoch:1.000 - critic/score/mean:0.948 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.948 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:1.733 - critic/advantages/min:-3.167 - critic/returns/mean:0.923 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.625 - critic/values/max:1.062 - critic/values/min:0.000 - critic/vf_explained_var:-1.312 - response_length/mean:183.347 - response_length/max:1024.000 - response_length/min:34.000 - response_length/clip_ratio:0.001 - prompt_length/mean:93.892 - prompt_length/max:205.000 - prompt_length/min:52.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.991 - timing_s/reward:0.692 - timing_s/old_log_prob:6.594 - timing_s/ref:6.412 - timing_s/values:27.991 - timing_s/adv:0.301 - timing_s/update_critic:100.556 - timing_s/update_actor:31.803 - timing_s/step:201.453 - timing_per_token_ms/values:0.020 - timing_per_token_ms/update_actor:0.022 - timing_per_token_ms/ref:0.005 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.029 - timing_per_token_ms/update_critic:0.071 - perf/total_num_tokens:1419464.000 - perf/time_per_step:201.453 - perf/throughput:880.767
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=3147479)[0m validation generation end
[36m(TaskRunner pid=3147479)[0m [prompt] system
[36m(TaskRunner pid=3147479)[0m You are a helpful assistant.
[36m(TaskRunner pid=3147479)[0m user
[36m(TaskRunner pid=3147479)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=3147479)[0m assistant
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m [response] Janet's ducks lay 16 eggs per day. She eats 3 for breakfast and uses 4 for baking, so she uses a total of \(3 + 4 = 7\) eggs daily.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m This means she has \(16 - 7 = 9\) eggs left to sell at the farmers' market.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m Since she sells each egg for $2, the total amount she makes from selling the eggs is \(9 \times 2 = 18\) dollars per day.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m #### 18
[36m(TaskRunner pid=3147479)[0m [ground_truth] 18
[36m(TaskRunner pid=3147479)[0m [score] 1.0
[36m(TaskRunner pid=3147479)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=3147479)[0m validation generation end
[36m(TaskRunner pid=3147479)[0m [prompt] system
[36m(TaskRunner pid=3147479)[0m You are a helpful assistant.
[36m(TaskRunner pid=3147479)[0m user
[36m(TaskRunner pid=3147479)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=3147479)[0m assistant
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m [response]  Tom's restaurant gets 6 reservations a night and they are open 2 days a week, so they get 6*2 = 12 reservations a week.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m For each reservation, they order 2 meals that cost $5 each, so that's 2*5 = $10 per reservation for meals.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m They also order a $5 bottle of wine per reservation, so that's an additional $5 per reservation.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m So in total, for each reservation, they spend 10+5 = $15.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m Therefore, for 12 reservations a week, they spend 12*15 = $180 a week.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m However, the question asks how much they make a week, not how much they spend. Since they spend $180 a week, and they get 12 reservations a week, they must be making 12*15 = $180 a week.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m So the answer is $180. 
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m #### 180
[36m(TaskRunner pid=3147479)[0m [ground_truth] 180
[36m(TaskRunner pid=3147479)[0m [score] 1.0
[36m(TaskRunner pid=3147479)[0m step:15 - global_seqlen/min:166043.000 - global_seqlen/max:186744.000 - global_seqlen/minmax_diff:20701.000 - global_seqlen/balanced_min:174004.000 - global_seqlen/balanced_max:174005.000 - global_seqlen/mean:174004.250 - actor/entropy_loss:0.209 - critic/vf_loss:0.047 - critic/vf_clipfrac:0.183 - critic/vpred_mean:0.903 - critic/grad_norm:14.735 - perf/mfu/critic:0.083 - critic/lr:0.000 - actor/kl_loss:0.034 - actor/kl_coef:0.001 - actor/pg_loss:0.006 - actor/pg_clipfrac:0.004 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.746 - perf/mfu/actor:0.242 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.545 - perf/cpu_memory_used_gb:51.028 - actor/lr:0.000 - val-core/openai/gsm8k/reward/mean@1:0.875 - val-aux/openai/gsm8k/reward/std@1:0.000 - val-core/openai/gsm8k/reward/best@1/mean:0.875 - val-aux/openai/gsm8k/reward/worst@1/mean:0.875 - training/global_step:15.000 - training/epoch:2.000 - critic/score/mean:0.956 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.956 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:1.836 - critic/advantages/min:-3.184 - critic/returns/mean:0.927 - critic/returns/max:1.000 - critic/returns/min:-0.000 - critic/values/mean:0.656 - critic/values/max:1.039 - critic/values/min:-0.508 - critic/vf_explained_var:-1.321 - response_length/mean:178.632 - response_length/max:1024.000 - response_length/min:22.000 - response_length/clip_ratio:0.001 - prompt_length/mean:93.250 - prompt_length/max:189.000 - prompt_length/min:56.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.351 - timing_s/reward:0.682 - timing_s/old_log_prob:6.386 - timing_s/ref:6.281 - timing_s/values:27.335 - timing_s/adv:0.248 - timing_s/update_critic:98.206 - timing_s/update_actor:33.630 - timing_s/testing:23.352 - timing_s/step:222.610 - timing_per_token_ms/values:0.020 - timing_per_token_ms/update_actor:0.024 - timing_per_token_ms/ref:0.005 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.029 - timing_per_token_ms/update_critic:0.071 - perf/total_num_tokens:1392034.000 - perf/time_per_step:222.610 - perf/throughput:781.655
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:16 - global_seqlen/min:167360.000 - global_seqlen/max:178187.000 - global_seqlen/minmax_diff:10827.000 - global_seqlen/balanced_min:172689.000 - global_seqlen/balanced_max:172782.000 - global_seqlen/mean:172720.875 - actor/entropy_loss:0.211 - critic/vf_loss:0.049 - critic/vf_clipfrac:0.182 - critic/vpred_mean:0.913 - critic/grad_norm:13.161 - perf/mfu/critic:0.082 - critic/lr:0.000 - actor/kl_loss:0.030 - actor/kl_coef:0.001 - actor/pg_loss:0.015 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.782 - perf/mfu/actor:0.222 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.545 - perf/cpu_memory_used_gb:51.183 - actor/lr:0.000 - training/global_step:16.000 - training/epoch:2.000 - critic/score/mean:0.956 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.956 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:1.854 - critic/advantages/min:-3.228 - critic/returns/mean:0.935 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.660 - critic/values/max:1.039 - critic/values/min:0.000 - critic/vf_explained_var:-1.514 - response_length/mean:176.028 - response_length/max:1024.000 - response_length/min:37.000 - response_length/clip_ratio:0.001 - prompt_length/mean:93.849 - prompt_length/max:222.000 - prompt_length/min:56.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:23.642 - timing_s/reward:0.684 - timing_s/old_log_prob:6.460 - timing_s/ref:6.149 - timing_s/values:27.453 - timing_s/adv:0.311 - timing_s/update_critic:97.680 - timing_s/update_actor:36.380 - timing_s/step:198.857 - timing_per_token_ms/values:0.020 - timing_per_token_ms/update_actor:0.026 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.026 - timing_per_token_ms/update_critic:0.071 - perf/total_num_tokens:1381767.000 - perf/time_per_step:198.857 - perf/throughput:868.567
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:17 - global_seqlen/min:172021.000 - global_seqlen/max:180323.000 - global_seqlen/minmax_diff:8302.000 - global_seqlen/balanced_min:174864.000 - global_seqlen/balanced_max:174865.000 - global_seqlen/mean:174864.125 - actor/entropy_loss:0.221 - critic/vf_loss:0.050 - critic/vf_clipfrac:0.187 - critic/vpred_mean:0.906 - critic/grad_norm:13.704 - perf/mfu/critic:0.083 - critic/lr:0.000 - actor/kl_loss:0.034 - actor/kl_coef:0.001 - actor/pg_loss:-0.014 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.801 - perf/mfu/actor:0.262 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.545 - perf/cpu_memory_used_gb:51.292 - actor/lr:0.000 - training/global_step:17.000 - training/epoch:2.000 - critic/score/mean:0.954 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.954 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.000 - critic/advantages/max:1.810 - critic/advantages/min:-3.032 - critic/returns/mean:0.931 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.668 - critic/values/max:1.047 - critic/values/min:0.000 - critic/vf_explained_var:-1.580 - response_length/mean:178.523 - response_length/max:1024.000 - response_length/min:35.000 - response_length/clip_ratio:0.000 - prompt_length/mean:94.702 - prompt_length/max:246.000 - prompt_length/min:52.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:25.589 - timing_s/reward:0.707 - timing_s/old_log_prob:6.463 - timing_s/ref:6.207 - timing_s/values:27.422 - timing_s/adv:0.230 - timing_s/update_critic:97.951 - timing_s/update_actor:31.199 - timing_s/step:195.886 - timing_per_token_ms/values:0.020 - timing_per_token_ms/update_actor:0.022 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.028 - timing_per_token_ms/update_critic:0.070 - perf/total_num_tokens:1398913.000 - perf/time_per_step:195.886 - perf/throughput:892.683
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:18 - global_seqlen/min:172577.000 - global_seqlen/max:180725.000 - global_seqlen/minmax_diff:8148.000 - global_seqlen/balanced_min:176766.000 - global_seqlen/balanced_max:176792.000 - global_seqlen/mean:176773.125 - actor/entropy_loss:0.214 - critic/vf_loss:0.049 - critic/vf_clipfrac:0.183 - critic/vpred_mean:0.887 - critic/grad_norm:13.178 - perf/mfu/critic:0.084 - critic/lr:0.000 - actor/kl_loss:0.045 - actor/kl_coef:0.001 - actor/pg_loss:0.018 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.838 - perf/mfu/actor:0.233 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.547 - perf/cpu_memory_used_gb:51.375 - actor/lr:0.000 - training/global_step:18.000 - training/epoch:2.000 - critic/score/mean:0.961 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.961 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:1.797 - critic/advantages/min:-4.316 - critic/returns/mean:0.941 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.645 - critic/values/max:1.398 - critic/values/min:0.000 - critic/vf_explained_var:-1.779 - response_length/mean:182.031 - response_length/max:1024.000 - response_length/min:32.000 - response_length/clip_ratio:0.000 - prompt_length/mean:94.177 - prompt_length/max:212.000 - prompt_length/min:55.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.344 - timing_s/reward:0.693 - timing_s/old_log_prob:6.632 - timing_s/ref:6.294 - timing_s/values:28.525 - timing_s/adv:0.253 - timing_s/update_critic:98.645 - timing_s/update_actor:35.450 - timing_s/step:202.926 - timing_per_token_ms/values:0.020 - timing_per_token_ms/update_actor:0.025 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.028 - timing_per_token_ms/update_critic:0.070 - perf/total_num_tokens:1414185.000 - perf/time_per_step:202.926 - perf/throughput:871.122
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:19 - global_seqlen/min:165984.000 - global_seqlen/max:175712.000 - global_seqlen/minmax_diff:9728.000 - global_seqlen/balanced_min:170609.000 - global_seqlen/balanced_max:170610.000 - global_seqlen/mean:170609.500 - actor/entropy_loss:0.209 - critic/vf_loss:0.050 - critic/vf_clipfrac:0.171 - critic/vpred_mean:0.892 - critic/grad_norm:12.159 - perf/mfu/critic:0.081 - critic/lr:0.000 - actor/kl_loss:0.050 - actor/kl_coef:0.001 - actor/pg_loss:0.038 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.700 - perf/mfu/actor:0.246 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.547 - perf/cpu_memory_used_gb:51.566 - actor/lr:0.000 - training/global_step:19.000 - training/epoch:2.000 - critic/score/mean:0.953 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.953 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.000 - critic/advantages/max:1.824 - critic/advantages/min:-3.253 - critic/returns/mean:0.929 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.641 - critic/values/max:1.078 - critic/values/min:0.000 - critic/vf_explained_var:-1.284 - response_length/mean:173.356 - response_length/max:1024.000 - response_length/min:34.000 - response_length/clip_ratio:0.001 - prompt_length/mean:93.222 - prompt_length/max:192.000 - prompt_length/min:55.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:27.171 - timing_s/reward:0.671 - timing_s/old_log_prob:6.244 - timing_s/ref:6.017 - timing_s/values:27.434 - timing_s/adv:0.216 - timing_s/update_critic:98.457 - timing_s/update_actor:32.353 - timing_s/step:198.958 - timing_per_token_ms/values:0.020 - timing_per_token_ms/update_actor:0.024 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.031 - timing_per_token_ms/update_critic:0.072 - perf/total_num_tokens:1364876.000 - perf/time_per_step:198.958 - perf/throughput:857.516
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=3147479)[0m validation generation end
[36m(TaskRunner pid=3147479)[0m [prompt] system
[36m(TaskRunner pid=3147479)[0m You are a helpful assistant.
[36m(TaskRunner pid=3147479)[0m user
[36m(TaskRunner pid=3147479)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=3147479)[0m assistant
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m [response]  Janet's ducks lay 16 eggs per day. She eats 3 for breakfast and bakes muffins with 4, so she uses 3 + 4 = 7 eggs per day.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m This means she has 16 - 7 = 9 eggs left to sell at the farmers' market.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m She sells each egg for $2, so she makes 9 * $2 = $18 every day at the farmers' market.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m #### 18
[36m(TaskRunner pid=3147479)[0m [ground_truth] 18
[36m(TaskRunner pid=3147479)[0m [score] 1.0
[36m(TaskRunner pid=3147479)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=3147479)[0m validation generation end
[36m(TaskRunner pid=3147479)[0m [prompt] system
[36m(TaskRunner pid=3147479)[0m You are a helpful assistant.
[36m(TaskRunner pid=3147479)[0m user
[36m(TaskRunner pid=3147479)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=3147479)[0m assistant
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m [response]  Tom's restaurant gets 6 reservations a night and they are open 2 days a week, so they get 6*2 = 12 reservations a week.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m For each reservation, they order 2 meals that cost $5 each, so each meal costs 2*$5 = $10.
[36m(TaskRunner pid=3147479)[0m So for each reservation, they spend $10*2 = $20 on meals.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m They also order a $5 bottle of wine for each reservation, so for each reservation, they spend $20+$5 = $25 in total.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m If they get 12 reservations a week, they spend 12*$25 = $300 a week on meals and wine.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m They are open 2 days a week, so they make $300 a week. The answer is: $#### 300$
[36m(TaskRunner pid=3147479)[0m [ground_truth] 180
[36m(TaskRunner pid=3147479)[0m [score] 0.0
[36m(TaskRunner pid=3147479)[0m step:20 - global_seqlen/min:164381.000 - global_seqlen/max:171198.000 - global_seqlen/minmax_diff:6817.000 - global_seqlen/balanced_min:168566.000 - global_seqlen/balanced_max:168656.000 - global_seqlen/mean:168592.875 - actor/entropy_loss:0.205 - critic/vf_loss:0.049 - critic/vf_clipfrac:0.180 - critic/vpred_mean:0.914 - critic/grad_norm:13.528 - perf/mfu/critic:0.080 - critic/lr:0.000 - actor/kl_loss:0.047 - actor/kl_coef:0.001 - actor/pg_loss:0.021 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.674 - perf/mfu/actor:0.243 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.547 - perf/cpu_memory_used_gb:51.561 - actor/lr:0.000 - val-core/openai/gsm8k/reward/mean@1:0.890 - val-aux/openai/gsm8k/reward/std@1:0.000 - val-core/openai/gsm8k/reward/best@1/mean:0.890 - val-aux/openai/gsm8k/reward/worst@1/mean:0.890 - training/global_step:20.000 - training/epoch:2.000 - critic/score/mean:0.958 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.958 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:1.832 - critic/advantages/min:-3.122 - critic/returns/mean:0.940 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.660 - critic/values/max:1.008 - critic/values/min:0.000 - critic/vf_explained_var:-1.765 - response_length/mean:169.735 - response_length/max:1024.000 - response_length/min:32.000 - response_length/clip_ratio:0.000 - prompt_length/mean:93.691 - prompt_length/max:228.000 - prompt_length/min:46.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:24.687 - timing_s/reward:0.658 - timing_s/old_log_prob:6.435 - timing_s/ref:5.941 - timing_s/values:27.487 - timing_s/adv:0.246 - timing_s/update_critic:97.906 - timing_s/update_actor:32.388 - timing_s/testing:24.098 - timing_s/step:219.939 - timing_per_token_ms/values:0.020 - timing_per_token_ms/update_actor:0.024 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.028 - timing_per_token_ms/update_critic:0.073 - perf/total_num_tokens:1348743.000 - perf/time_per_step:219.939 - perf/throughput:766.543
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:21 - global_seqlen/min:161821.000 - global_seqlen/max:176433.000 - global_seqlen/minmax_diff:14612.000 - global_seqlen/balanced_min:168478.000 - global_seqlen/balanced_max:168479.000 - global_seqlen/mean:168478.375 - actor/entropy_loss:0.200 - critic/vf_loss:0.044 - critic/vf_clipfrac:0.170 - critic/vpred_mean:0.884 - critic/grad_norm:11.869 - perf/mfu/critic:0.079 - critic/lr:0.000 - actor/kl_loss:0.056 - actor/kl_coef:0.001 - actor/pg_loss:0.065 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.752 - perf/mfu/actor:0.264 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.547 - perf/cpu_memory_used_gb:51.613 - actor/lr:0.000 - training/global_step:21.000 - training/epoch:2.000 - critic/score/mean:0.964 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.964 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:1.856 - critic/advantages/min:-3.139 - critic/returns/mean:0.948 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.672 - critic/values/max:1.000 - critic/values/min:0.000 - critic/vf_explained_var:-2.084 - response_length/mean:170.491 - response_length/max:842.000 - response_length/min:38.000 - response_length/clip_ratio:0.000 - prompt_length/mean:92.757 - prompt_length/max:186.000 - prompt_length/min:53.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.231 - timing_s/reward:0.637 - timing_s/old_log_prob:6.324 - timing_s/ref:5.936 - timing_s/values:27.249 - timing_s/adv:0.252 - timing_s/update_critic:99.969 - timing_s/update_actor:29.833 - timing_s/step:191.555 - timing_per_token_ms/values:0.020 - timing_per_token_ms/update_actor:0.022 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.024 - timing_per_token_ms/update_critic:0.074 - perf/total_num_tokens:1347827.000 - perf/time_per_step:191.555 - perf/throughput:879.531
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:22 - global_seqlen/min:161063.000 - global_seqlen/max:175803.000 - global_seqlen/minmax_diff:14740.000 - global_seqlen/balanced_min:169686.000 - global_seqlen/balanced_max:169746.000 - global_seqlen/mean:169702.250 - actor/entropy_loss:0.207 - critic/vf_loss:0.051 - critic/vf_clipfrac:0.167 - critic/vpred_mean:0.878 - critic/grad_norm:12.825 - perf/mfu/critic:0.080 - critic/lr:0.000 - actor/kl_loss:0.060 - actor/kl_coef:0.001 - actor/pg_loss:0.053 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.666 - perf/mfu/actor:0.225 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.547 - perf/cpu_memory_used_gb:51.660 - actor/lr:0.000 - training/global_step:22.000 - training/epoch:3.000 - critic/score/mean:0.961 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.961 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:2.305 - critic/advantages/min:-3.404 - critic/returns/mean:0.935 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.617 - critic/values/max:1.078 - critic/values/min:-0.277 - critic/vf_explained_var:-1.235 - response_length/mean:172.178 - response_length/max:1024.000 - response_length/min:36.000 - response_length/clip_ratio:0.000 - prompt_length/mean:92.981 - prompt_length/max:201.000 - prompt_length/min:55.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.431 - timing_s/reward:0.684 - timing_s/old_log_prob:6.385 - timing_s/ref:6.114 - timing_s/values:28.215 - timing_s/adv:0.364 - timing_s/update_critic:98.759 - timing_s/update_actor:35.160 - timing_s/step:202.227 - timing_per_token_ms/values:0.021 - timing_per_token_ms/update_actor:0.026 - timing_per_token_ms/ref:0.005 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.030 - timing_per_token_ms/update_critic:0.073 - perf/total_num_tokens:1357618.000 - perf/time_per_step:202.227 - perf/throughput:839.168
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:23 - global_seqlen/min:169860.000 - global_seqlen/max:180502.000 - global_seqlen/minmax_diff:10642.000 - global_seqlen/balanced_min:176478.000 - global_seqlen/balanced_max:176479.000 - global_seqlen/mean:176478.750 - actor/entropy_loss:0.215 - critic/vf_loss:0.049 - critic/vf_clipfrac:0.167 - critic/vpred_mean:0.857 - critic/grad_norm:12.632 - perf/mfu/critic:0.084 - critic/lr:0.000 - actor/kl_loss:0.042 - actor/kl_coef:0.001 - actor/pg_loss:0.037 - actor/pg_clipfrac:0.004 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.754 - perf/mfu/actor:0.252 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.547 - perf/cpu_memory_used_gb:51.677 - actor/lr:0.000 - training/global_step:23.000 - training/epoch:3.000 - critic/score/mean:0.959 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.959 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.000 - critic/advantages/max:1.884 - critic/advantages/min:-3.123 - critic/returns/mean:0.930 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.672 - critic/values/max:1.000 - critic/values/min:0.000 - critic/vf_explained_var:-1.385 - response_length/mean:181.452 - response_length/max:1024.000 - response_length/min:42.000 - response_length/clip_ratio:0.000 - prompt_length/mean:94.296 - prompt_length/max:246.000 - prompt_length/min:56.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:25.715 - timing_s/reward:0.696 - timing_s/old_log_prob:6.468 - timing_s/ref:6.164 - timing_s/values:27.798 - timing_s/adv:0.226 - timing_s/update_critic:97.546 - timing_s/update_actor:32.635 - timing_s/step:197.416 - timing_per_token_ms/values:0.020 - timing_per_token_ms/update_actor:0.023 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.028 - timing_per_token_ms/update_critic:0.069 - perf/total_num_tokens:1411830.000 - perf/time_per_step:197.416 - perf/throughput:893.943
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:24 - global_seqlen/min:164376.000 - global_seqlen/max:180946.000 - global_seqlen/minmax_diff:16570.000 - global_seqlen/balanced_min:172015.000 - global_seqlen/balanced_max:172163.000 - global_seqlen/mean:172034.000 - actor/entropy_loss:0.211 - critic/vf_loss:0.043 - critic/vf_clipfrac:0.183 - critic/vpred_mean:0.911 - critic/grad_norm:12.138 - perf/mfu/critic:0.081 - critic/lr:0.000 - actor/kl_loss:0.056 - actor/kl_coef:0.001 - actor/pg_loss:-0.006 - actor/pg_clipfrac:0.004 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.623 - perf/mfu/actor:0.233 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.547 - perf/cpu_memory_used_gb:51.771 - actor/lr:0.000 - training/global_step:24.000 - training/epoch:3.000 - critic/score/mean:0.960 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.960 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.000 - critic/advantages/max:1.872 - critic/advantages/min:-3.181 - critic/returns/mean:0.945 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.664 - critic/values/max:1.000 - critic/values/min:0.000 - critic/vf_explained_var:-1.821 - response_length/mean:174.716 - response_length/max:1024.000 - response_length/min:41.000 - response_length/clip_ratio:0.000 - prompt_length/mean:94.087 - prompt_length/max:202.000 - prompt_length/min:52.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:24.096 - timing_s/reward:0.678 - timing_s/old_log_prob:6.313 - timing_s/ref:6.050 - timing_s/values:28.218 - timing_s/adv:0.234 - timing_s/update_critic:98.840 - timing_s/update_actor:34.509 - timing_s/step:199.024 - timing_per_token_ms/values:0.021 - timing_per_token_ms/update_actor:0.025 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.027 - timing_per_token_ms/update_critic:0.072 - perf/total_num_tokens:1376272.000 - perf/time_per_step:199.024 - perf/throughput:864.389
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=3147479)[0m validation generation end
[36m(TaskRunner pid=3147479)[0m [prompt] system
[36m(TaskRunner pid=3147479)[0m You are a helpful assistant.
[36m(TaskRunner pid=3147479)[0m user
[36m(TaskRunner pid=3147479)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=3147479)[0m assistant
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m [response]  Janet's ducks lay 16 eggs per day. She eats 3 for breakfast and bakes muffins with 4, so she uses 3 + 4 = 7 eggs per day.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m This means she has 16 - 7 = 9 eggs left to sell at the farmers' market.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m She sells each egg for $2, so she makes 9 * $2 = $18 every day at the farmers' market.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m #### 18
[36m(TaskRunner pid=3147479)[0m [ground_truth] 18
[36m(TaskRunner pid=3147479)[0m [score] 1.0
[36m(TaskRunner pid=3147479)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=3147479)[0m validation generation end
[36m(TaskRunner pid=3147479)[0m [prompt] system
[36m(TaskRunner pid=3147479)[0m You are a helpful assistant.
[36m(TaskRunner pid=3147479)[0m user
[36m(TaskRunner pid=3147479)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=3147479)[0m assistant
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m [response]  Tom's restaurant gets 6 reservations a night and they are open 2 days a week, so they get 6*2 = 12 reservations a week.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m For each reservation, they order 2 meals that cost $5 each, so each meal costs 2*$5 = $10.
[36m(TaskRunner pid=3147479)[0m So for each reservation, they spend $10*2 = $20 on meals.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m They also order a $5 bottle of wine for each reservation, so for each reservation, they spend $20+$5 = $25 in total.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m If they get 12 reservations a week, they spend 12*$25 = $300 a week on meals and wine.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m They are open 2 days a week, so they make $300 a week. The answer is: $#### 300$
[36m(TaskRunner pid=3147479)[0m [ground_truth] 180
[36m(TaskRunner pid=3147479)[0m [score] 0.0
[36m(TaskRunner pid=3147479)[0m step:25 - global_seqlen/min:163469.000 - global_seqlen/max:182971.000 - global_seqlen/minmax_diff:19502.000 - global_seqlen/balanced_min:175094.000 - global_seqlen/balanced_max:175094.000 - global_seqlen/mean:175094.000 - actor/entropy_loss:0.220 - critic/vf_loss:0.049 - critic/vf_clipfrac:0.182 - critic/vpred_mean:0.872 - critic/grad_norm:11.644 - perf/mfu/critic:0.081 - critic/lr:0.000 - actor/kl_loss:0.066 - actor/kl_coef:0.001 - actor/pg_loss:0.028 - actor/pg_clipfrac:0.004 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.750 - perf/mfu/actor:0.271 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.547 - perf/cpu_memory_used_gb:51.894 - actor/lr:0.000 - val-core/openai/gsm8k/reward/mean@1:0.876 - val-aux/openai/gsm8k/reward/std@1:0.000 - val-core/openai/gsm8k/reward/best@1/mean:0.876 - val-aux/openai/gsm8k/reward/worst@1/mean:0.876 - training/global_step:25.000 - training/epoch:3.000 - critic/score/mean:0.951 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.951 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.000 - critic/advantages/max:2.310 - critic/advantages/min:-3.100 - critic/returns/mean:0.924 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.648 - critic/values/max:1.008 - critic/values/min:-0.447 - critic/vf_explained_var:-1.208 - response_length/mean:179.938 - response_length/max:1024.000 - response_length/min:35.000 - response_length/clip_ratio:0.001 - prompt_length/mean:93.646 - prompt_length/max:186.000 - prompt_length/min:55.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:28.075 - timing_s/reward:0.669 - timing_s/old_log_prob:6.401 - timing_s/ref:6.152 - timing_s/values:28.307 - timing_s/adv:0.233 - timing_s/update_critic:101.051 - timing_s/update_actor:30.150 - timing_s/testing:22.995 - timing_s/step:224.132 - timing_per_token_ms/values:0.020 - timing_per_token_ms/update_actor:0.022 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.030 - timing_per_token_ms/update_critic:0.072 - perf/total_num_tokens:1400752.000 - perf/time_per_step:224.132 - perf/throughput:781.208
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:26 - global_seqlen/min:169060.000 - global_seqlen/max:183726.000 - global_seqlen/minmax_diff:14666.000 - global_seqlen/balanced_min:175249.000 - global_seqlen/balanced_max:175249.000 - global_seqlen/mean:175249.000 - actor/entropy_loss:0.229 - critic/vf_loss:0.051 - critic/vf_clipfrac:0.192 - critic/vpred_mean:0.921 - critic/grad_norm:15.654 - perf/mfu/critic:0.082 - critic/lr:0.000 - actor/kl_loss:0.048 - actor/kl_coef:0.001 - actor/pg_loss:0.004 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.932 - perf/mfu/actor:0.238 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.547 - perf/cpu_memory_used_gb:52.027 - actor/lr:0.000 - training/global_step:26.000 - training/epoch:3.000 - critic/score/mean:0.965 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.965 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.000 - critic/advantages/max:1.822 - critic/advantages/min:-3.194 - critic/returns/mean:0.947 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.648 - critic/values/max:0.988 - critic/values/min:-0.034 - critic/vf_explained_var:-1.957 - response_length/mean:179.212 - response_length/max:1024.000 - response_length/min:36.000 - response_length/clip_ratio:0.001 - prompt_length/mean:94.614 - prompt_length/max:228.000 - prompt_length/min:53.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:23.206 - timing_s/reward:0.705 - timing_s/old_log_prob:6.507 - timing_s/ref:6.207 - timing_s/values:28.112 - timing_s/adv:0.265 - timing_s/update_critic:99.526 - timing_s/update_actor:34.372 - timing_s/step:198.999 - timing_per_token_ms/values:0.020 - timing_per_token_ms/update_actor:0.025 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.025 - timing_per_token_ms/update_critic:0.071 - perf/total_num_tokens:1401992.000 - perf/time_per_step:198.999 - perf/throughput:880.651
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:27 - global_seqlen/min:168227.000 - global_seqlen/max:182381.000 - global_seqlen/minmax_diff:14154.000 - global_seqlen/balanced_min:172668.000 - global_seqlen/balanced_max:172668.000 - global_seqlen/mean:172668.000 - actor/entropy_loss:0.225 - critic/vf_loss:0.086 - critic/vf_clipfrac:0.191 - critic/vpred_mean:0.909 - critic/grad_norm:38.115 - perf/mfu/critic:0.079 - critic/lr:0.000 - actor/kl_loss:0.061 - actor/kl_coef:0.001 - actor/pg_loss:-0.025 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.672 - perf/mfu/actor:0.228 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.547 - perf/cpu_memory_used_gb:52.129 - actor/lr:0.000 - training/global_step:27.000 - training/epoch:3.000 - critic/score/mean:0.957 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.957 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:1.942 - critic/advantages/min:-2.358 - critic/returns/mean:0.934 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:1.039 - critic/values/max:2.016 - critic/values/min:0.000 - critic/vf_explained_var:-4.311 - response_length/mean:176.319 - response_length/max:1024.000 - response_length/min:48.000 - response_length/clip_ratio:0.001 - prompt_length/mean:93.475 - prompt_length/max:205.000 - prompt_length/min:55.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:23.783 - timing_s/reward:0.683 - timing_s/old_log_prob:6.301 - timing_s/ref:6.094 - timing_s/values:27.370 - timing_s/adv:0.254 - timing_s/update_critic:101.492 - timing_s/update_actor:35.354 - timing_s/step:201.537 - timing_per_token_ms/values:0.020 - timing_per_token_ms/update_actor:0.026 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.026 - timing_per_token_ms/update_critic:0.073 - perf/total_num_tokens:1381344.000 - perf/time_per_step:201.537 - perf/throughput:856.758
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:28 - global_seqlen/min:164822.000 - global_seqlen/max:173138.000 - global_seqlen/minmax_diff:8316.000 - global_seqlen/balanced_min:169468.000 - global_seqlen/balanced_max:169594.000 - global_seqlen/mean:169533.125 - actor/entropy_loss:0.230 - critic/vf_loss:0.047 - critic/vf_clipfrac:0.187 - critic/vpred_mean:0.911 - critic/grad_norm:13.815 - perf/mfu/critic:0.079 - critic/lr:0.000 - actor/kl_loss:0.059 - actor/kl_coef:0.001 - actor/pg_loss:0.004 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.682 - perf/mfu/actor:0.237 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.547 - perf/cpu_memory_used_gb:52.125 - actor/lr:0.000 - training/global_step:28.000 - training/epoch:3.000 - critic/score/mean:0.963 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.963 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.000 - critic/advantages/max:1.950 - critic/advantages/min:-2.572 - critic/returns/mean:0.943 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.957 - critic/values/max:1.648 - critic/values/min:0.000 - critic/vf_explained_var:-4.037 - response_length/mean:172.191 - response_length/max:1024.000 - response_length/min:29.000 - response_length/clip_ratio:0.001 - prompt_length/mean:92.704 - prompt_length/max:222.000 - prompt_length/min:46.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:25.626 - timing_s/reward:0.687 - timing_s/old_log_prob:6.160 - timing_s/ref:6.012 - timing_s/values:27.595 - timing_s/adv:0.213 - timing_s/update_critic:100.483 - timing_s/update_actor:33.367 - timing_s/step:200.244 - timing_per_token_ms/values:0.020 - timing_per_token_ms/update_actor:0.025 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.029 - timing_per_token_ms/update_critic:0.074 - perf/total_num_tokens:1356265.000 - perf/time_per_step:200.244 - perf/throughput:846.632
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:29 - global_seqlen/min:162448.000 - global_seqlen/max:173993.000 - global_seqlen/minmax_diff:11545.000 - global_seqlen/balanced_min:168849.000 - global_seqlen/balanced_max:168850.000 - global_seqlen/mean:168849.500 - actor/entropy_loss:0.242 - critic/vf_loss:0.047 - critic/vf_clipfrac:0.193 - critic/vpred_mean:0.944 - critic/grad_norm:15.482 - perf/mfu/critic:0.081 - critic/lr:0.000 - actor/kl_loss:0.069 - actor/kl_coef:0.001 - actor/pg_loss:-0.043 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.784 - perf/mfu/actor:0.236 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.547 - perf/cpu_memory_used_gb:51.630 - actor/lr:0.000 - training/global_step:29.000 - training/epoch:4.000 - critic/score/mean:0.967 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.967 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:1.900 - critic/advantages/min:-3.066 - critic/returns/mean:0.948 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.742 - critic/values/max:1.250 - critic/values/min:0.000 - critic/vf_explained_var:-2.544 - response_length/mean:169.414 - response_length/max:1024.000 - response_length/min:36.000 - response_length/clip_ratio:0.000 - prompt_length/mean:94.413 - prompt_length/max:246.000 - prompt_length/min:54.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:23.325 - timing_s/reward:0.676 - timing_s/old_log_prob:6.248 - timing_s/ref:5.948 - timing_s/values:27.345 - timing_s/adv:0.245 - timing_s/update_critic:97.395 - timing_s/update_actor:33.404 - timing_s/step:194.744 - timing_per_token_ms/values:0.020 - timing_per_token_ms/update_actor:0.025 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.027 - timing_per_token_ms/update_critic:0.072 - perf/total_num_tokens:1350796.000 - perf/time_per_step:194.744 - perf/throughput:867.032
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=3147479)[0m validation generation end
[36m(TaskRunner pid=3147479)[0m [prompt] system
[36m(TaskRunner pid=3147479)[0m You are a helpful assistant.
[36m(TaskRunner pid=3147479)[0m user
[36m(TaskRunner pid=3147479)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=3147479)[0m assistant
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m [response]  Janet's ducks lay 16 eggs per day.
[36m(TaskRunner pid=3147479)[0m She eats 3 for breakfast every morning, so she has \(16 - 3 = 13\) eggs left.
[36m(TaskRunner pid=3147479)[0m She bakes muffins for her friends every day with 4, so she has \(13 - 4 = 9\) eggs left.
[36m(TaskRunner pid=3147479)[0m She sells the remainder at the farmers' market daily for $2 per fresh duck egg, so she makes \(9 * 2 = 18\) dollars every day at the farmers' market.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m #### 18
[36m(TaskRunner pid=3147479)[0m [ground_truth] 18
[36m(TaskRunner pid=3147479)[0m [score] 1.0
[36m(TaskRunner pid=3147479)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=3147479)[0m validation generation end
[36m(TaskRunner pid=3147479)[0m [prompt] system
[36m(TaskRunner pid=3147479)[0m You are a helpful assistant.
[36m(TaskRunner pid=3147479)[0m user
[36m(TaskRunner pid=3147479)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=3147479)[0m assistant
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m [response]  Tom's restaurant gets 6 reservations a night and they are open 2 days a week, so they get \(6 \times 2 = 12\) reservations a week.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m Each reservation requires 2 meals at $5 each, so per reservation, they need \(2 \times 5 = 10\) dollars worth of meals.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m Therefore, for 12 reservations, they need \(12 \times 10 = 120\) dollars worth of meals.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m Additionally, each reservation also requires a $5 bottle of wine, so for 12 reservations, they need \(12 \times 5 = 60\) dollars worth of wine.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m Adding the cost of meals and wine together, they need \(120 + 60 = 180\) dollars worth of food and drink per week.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m Since they are open 2 days a week, the total amount they make in a week is \(180 \times 2 = 360\) dollars.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m #### 360
[36m(TaskRunner pid=3147479)[0m [ground_truth] 180
[36m(TaskRunner pid=3147479)[0m [score] 0.0
[36m(TaskRunner pid=3147479)[0m step:30 - global_seqlen/min:158587.000 - global_seqlen/max:176108.000 - global_seqlen/minmax_diff:17521.000 - global_seqlen/balanced_min:168216.000 - global_seqlen/balanced_max:168217.000 - global_seqlen/mean:168216.750 - actor/entropy_loss:0.238 - critic/vf_loss:0.063 - critic/vf_clipfrac:0.199 - critic/vpred_mean:0.893 - critic/grad_norm:23.139 - perf/mfu/critic:0.080 - critic/lr:0.000 - actor/kl_loss:0.069 - actor/kl_coef:0.001 - actor/pg_loss:-0.005 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.638 - perf/mfu/actor:0.238 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.547 - perf/cpu_memory_used_gb:51.630 - actor/lr:0.000 - val-core/openai/gsm8k/reward/mean@1:0.882 - val-aux/openai/gsm8k/reward/std@1:0.000 - val-core/openai/gsm8k/reward/best@1/mean:0.882 - val-aux/openai/gsm8k/reward/worst@1/mean:0.882 - training/global_step:30.000 - training/epoch:4.000 - critic/score/mean:0.966 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.966 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:4.608 - critic/advantages/min:-2.403 - critic/returns/mean:0.952 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:1.031 - critic/values/max:1.469 - critic/values/min:-1.516 - critic/vf_explained_var:-5.872 - response_length/mean:169.829 - response_length/max:920.000 - response_length/min:37.000 - response_length/clip_ratio:0.000 - prompt_length/mean:93.010 - prompt_length/max:189.000 - prompt_length/min:46.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:24.065 - timing_s/reward:0.682 - timing_s/old_log_prob:6.314 - timing_s/ref:5.932 - timing_s/values:27.726 - timing_s/adv:0.239 - timing_s/update_critic:98.431 - timing_s/update_actor:33.009 - timing_s/testing:23.499 - timing_s/step:219.987 - timing_per_token_ms/values:0.021 - timing_per_token_ms/update_actor:0.025 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.028 - timing_per_token_ms/update_critic:0.073 - perf/total_num_tokens:1345734.000 - perf/time_per_step:219.987 - perf/throughput:764.666
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:31 - global_seqlen/min:162931.000 - global_seqlen/max:177010.000 - global_seqlen/minmax_diff:14079.000 - global_seqlen/balanced_min:170799.000 - global_seqlen/balanced_max:170805.000 - global_seqlen/mean:170800.750 - actor/entropy_loss:0.243 - critic/vf_loss:0.046 - critic/vf_clipfrac:0.185 - critic/vpred_mean:0.907 - critic/grad_norm:14.112 - perf/mfu/critic:0.081 - critic/lr:0.000 - actor/kl_loss:0.069 - actor/kl_coef:0.001 - actor/pg_loss:0.024 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.622 - perf/mfu/actor:0.234 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.547 - perf/cpu_memory_used_gb:51.654 - actor/lr:0.000 - training/global_step:31.000 - training/epoch:4.000 - critic/score/mean:0.955 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.955 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:1.903 - critic/advantages/min:-2.940 - critic/returns/mean:0.932 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.762 - critic/values/max:1.164 - critic/values/min:-0.026 - critic/vf_explained_var:-2.018 - response_length/mean:173.584 - response_length/max:1024.000 - response_length/min:36.000 - response_length/clip_ratio:0.000 - prompt_length/mean:93.292 - prompt_length/max:212.000 - prompt_length/min:58.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:22.664 - timing_s/reward:0.685 - timing_s/old_log_prob:6.145 - timing_s/ref:6.084 - timing_s/values:27.316 - timing_s/adv:0.253 - timing_s/update_critic:98.466 - timing_s/update_actor:34.096 - timing_s/step:195.821 - timing_per_token_ms/values:0.020 - timing_per_token_ms/update_actor:0.025 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.026 - timing_per_token_ms/update_critic:0.072 - perf/total_num_tokens:1366406.000 - perf/time_per_step:195.821 - perf/throughput:872.229
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:32 - global_seqlen/min:168952.000 - global_seqlen/max:178918.000 - global_seqlen/minmax_diff:9966.000 - global_seqlen/balanced_min:173770.000 - global_seqlen/balanced_max:173770.000 - global_seqlen/mean:173770.000 - actor/entropy_loss:0.249 - critic/vf_loss:0.061 - critic/vf_clipfrac:0.187 - critic/vpred_mean:0.928 - critic/grad_norm:24.146 - perf/mfu/critic:0.081 - critic/lr:0.000 - actor/kl_loss:0.060 - actor/kl_coef:0.001 - actor/pg_loss:0.029 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.699 - perf/mfu/actor:0.239 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.547 - perf/cpu_memory_used_gb:51.779 - actor/lr:0.000 - training/global_step:32.000 - training/epoch:4.000 - critic/score/mean:0.961 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.961 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:1.933 - critic/advantages/min:-2.494 - critic/returns/mean:0.939 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.973 - critic/values/max:1.773 - critic/values/min:0.000 - critic/vf_explained_var:-3.991 - response_length/mean:176.944 - response_length/max:1024.000 - response_length/min:33.000 - response_length/clip_ratio:0.001 - prompt_length/mean:94.571 - prompt_length/max:228.000 - prompt_length/min:53.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:27.446 - timing_s/reward:0.697 - timing_s/old_log_prob:6.275 - timing_s/ref:6.183 - timing_s/values:27.268 - timing_s/adv:0.229 - timing_s/update_critic:99.876 - timing_s/update_actor:33.950 - timing_s/step:202.039 - timing_per_token_ms/values:0.020 - timing_per_token_ms/update_actor:0.024 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.030 - timing_per_token_ms/update_critic:0.072 - perf/total_num_tokens:1390160.000 - perf/time_per_step:202.039 - perf/throughput:860.082
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:33 - global_seqlen/min:165606.000 - global_seqlen/max:177956.000 - global_seqlen/minmax_diff:12350.000 - global_seqlen/balanced_min:170637.000 - global_seqlen/balanced_max:170709.000 - global_seqlen/mean:170682.000 - actor/entropy_loss:0.262 - critic/vf_loss:0.052 - critic/vf_clipfrac:0.167 - critic/vpred_mean:0.831 - critic/grad_norm:16.395 - perf/mfu/critic:0.080 - critic/lr:0.000 - actor/kl_loss:0.082 - actor/kl_coef:0.001 - actor/pg_loss:0.043 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.757 - perf/mfu/actor:0.241 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.547 - perf/cpu_memory_used_gb:51.647 - actor/lr:0.000 - training/global_step:33.000 - training/epoch:4.000 - critic/score/mean:0.960 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.960 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:1.911 - critic/advantages/min:-2.863 - critic/returns/mean:0.942 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.789 - critic/values/max:1.508 - critic/values/min:0.000 - critic/vf_explained_var:-2.592 - response_length/mean:173.881 - response_length/max:1024.000 - response_length/min:30.000 - response_length/clip_ratio:0.001 - prompt_length/mean:92.810 - prompt_length/max:202.000 - prompt_length/min:56.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:23.176 - timing_s/reward:0.715 - timing_s/old_log_prob:6.234 - timing_s/ref:6.019 - timing_s/values:27.591 - timing_s/adv:0.254 - timing_s/update_critic:99.682 - timing_s/update_actor:33.132 - timing_s/step:196.903 - timing_per_token_ms/values:0.020 - timing_per_token_ms/update_actor:0.024 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.026 - timing_per_token_ms/update_critic:0.073 - perf/total_num_tokens:1365456.000 - perf/time_per_step:196.903 - perf/throughput:866.834
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:34 - global_seqlen/min:172260.000 - global_seqlen/max:181312.000 - global_seqlen/minmax_diff:9052.000 - global_seqlen/balanced_min:176203.000 - global_seqlen/balanced_max:176204.000 - global_seqlen/mean:176203.250 - actor/entropy_loss:0.263 - critic/vf_loss:0.055 - critic/vf_clipfrac:0.177 - critic/vpred_mean:0.908 - critic/grad_norm:19.120 - perf/mfu/critic:0.084 - critic/lr:0.000 - actor/kl_loss:0.077 - actor/kl_coef:0.001 - actor/pg_loss:-0.018 - actor/pg_clipfrac:0.004 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.599 - perf/mfu/actor:0.244 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.555 - perf/cpu_memory_used_gb:51.837 - actor/lr:0.000 - training/global_step:34.000 - training/epoch:4.000 - critic/score/mean:0.960 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.960 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.000 - critic/advantages/max:2.266 - critic/advantages/min:-3.162 - critic/returns/mean:0.943 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.711 - critic/values/max:1.148 - critic/values/min:-0.547 - critic/vf_explained_var:-2.091 - response_length/mean:180.981 - response_length/max:1024.000 - response_length/min:35.000 - response_length/clip_ratio:0.001 - prompt_length/mean:94.337 - prompt_length/max:207.000 - prompt_length/min:56.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.081 - timing_s/reward:0.710 - timing_s/old_log_prob:6.343 - timing_s/ref:6.126 - timing_s/values:28.473 - timing_s/adv:0.252 - timing_s/update_critic:97.942 - timing_s/update_actor:33.689 - timing_s/step:199.732 - timing_per_token_ms/values:0.020 - timing_per_token_ms/update_actor:0.024 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.028 - timing_per_token_ms/update_critic:0.069 - perf/total_num_tokens:1409626.000 - perf/time_per_step:199.732 - perf/throughput:882.200
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=3147479)[0m validation generation end
[36m(TaskRunner pid=3147479)[0m [prompt] system
[36m(TaskRunner pid=3147479)[0m You are a helpful assistant.
[36m(TaskRunner pid=3147479)[0m user
[36m(TaskRunner pid=3147479)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=3147479)[0m assistant
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m [response]  Janet's ducks lay 16 eggs per day.
[36m(TaskRunner pid=3147479)[0m She eats 3 for breakfast every morning, so she has \(16 - 3 = 13\) eggs left.
[36m(TaskRunner pid=3147479)[0m She bakes muffins for her friends every day with 4, so she has \(13 - 4 = 9\) eggs left.
[36m(TaskRunner pid=3147479)[0m She sells the remainder at the farmers' market daily for $2 per fresh duck egg, so she makes \(9 * 2 = 18\) dollars every day at the farmers' market.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m #### 18
[36m(TaskRunner pid=3147479)[0m [ground_truth] 18
[36m(TaskRunner pid=3147479)[0m [score] 1.0
[36m(TaskRunner pid=3147479)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=3147479)[0m validation generation end
[36m(TaskRunner pid=3147479)[0m [prompt] system
[36m(TaskRunner pid=3147479)[0m You are a helpful assistant.
[36m(TaskRunner pid=3147479)[0m user
[36m(TaskRunner pid=3147479)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=3147479)[0m assistant
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m [response] First, let's calculate the cost for each night's dinner preparation:
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m Each night, they order 2 meals at $5 each, so the cost for meals is \(2 * $5 = $10\).
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m They also order a $5 bottle of wine, so the total cost per night is \( $10 + $5 = $15\).
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m Since they are open 2 days a week, the total cost per week is \(2 * $15 = $30\).
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m However, we also need to calculate their earnings per week. Since they get 6 reservations a night and are open 2 nights a week, they have a total of \(6 * 2 = 12\) reservations per week.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m Assuming each reservation results in a meal purchase (which is a simplification, as reservations might not always result in a meal purchase), and each meal is sold at $5, their total earnings per week are \(12 * $5 = $60\).
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m Finally, to find out how much they make in profit per week, we subtract the total cost from the total earnings:
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m \( $60 - $30 = $30\).
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m So, they make $30 a week. The answer is:
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m #### 30
[36m(TaskRunner pid=3147479)[0m [ground_truth] 180
[36m(TaskRunner pid=3147479)[0m [score] 0.0
[36m(TaskRunner pid=3147479)[0m step:35 - global_seqlen/min:167690.000 - global_seqlen/max:180105.000 - global_seqlen/minmax_diff:12415.000 - global_seqlen/balanced_min:173551.000 - global_seqlen/balanced_max:173656.000 - global_seqlen/mean:173599.125 - actor/entropy_loss:0.276 - critic/vf_loss:0.046 - critic/vf_clipfrac:0.187 - critic/vpred_mean:0.953 - critic/grad_norm:11.194 - perf/mfu/critic:0.081 - critic/lr:0.000 - actor/kl_loss:0.074 - actor/kl_coef:0.001 - actor/pg_loss:-0.004 - actor/pg_clipfrac:0.004 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.632 - perf/mfu/actor:0.241 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.555 - perf/cpu_memory_used_gb:51.853 - actor/lr:0.000 - val-core/openai/gsm8k/reward/mean@1:0.875 - val-aux/openai/gsm8k/reward/std@1:0.000 - val-core/openai/gsm8k/reward/best@1/mean:0.875 - val-aux/openai/gsm8k/reward/worst@1/mean:0.875 - training/global_step:35.000 - training/epoch:4.000 - critic/score/mean:0.964 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.964 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.000 - critic/advantages/max:1.919 - critic/advantages/min:-2.748 - critic/returns/mean:0.948 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.820 - critic/values/max:1.234 - critic/values/min:0.000 - critic/vf_explained_var:-3.204 - response_length/mean:177.874 - response_length/max:978.000 - response_length/min:33.000 - response_length/clip_ratio:0.000 - prompt_length/mean:93.375 - prompt_length/max:222.000 - prompt_length/min:53.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:24.591 - timing_s/reward:0.684 - timing_s/old_log_prob:6.303 - timing_s/ref:6.149 - timing_s/values:28.392 - timing_s/adv:0.255 - timing_s/update_critic:99.366 - timing_s/update_actor:33.599 - timing_s/testing:29.921 - timing_s/step:229.356 - timing_per_token_ms/values:0.020 - timing_per_token_ms/update_actor:0.024 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.027 - timing_per_token_ms/update_critic:0.072 - perf/total_num_tokens:1388793.000 - perf/time_per_step:229.356 - perf/throughput:756.897
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:36 - global_seqlen/min:165115.000 - global_seqlen/max:177995.000 - global_seqlen/minmax_diff:12880.000 - global_seqlen/balanced_min:171363.000 - global_seqlen/balanced_max:171364.000 - global_seqlen/mean:171363.875 - actor/entropy_loss:0.272 - critic/vf_loss:0.052 - critic/vf_clipfrac:0.185 - critic/vpred_mean:0.908 - critic/grad_norm:17.340 - perf/mfu/critic:0.082 - critic/lr:0.000 - actor/kl_loss:0.078 - actor/kl_coef:0.001 - actor/pg_loss:0.030 - actor/pg_clipfrac:0.004 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.697 - perf/mfu/actor:0.253 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.555 - perf/cpu_memory_used_gb:51.770 - actor/lr:0.000 - training/global_step:36.000 - training/epoch:5.000 - critic/score/mean:0.958 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.958 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:2.156 - critic/advantages/min:-3.033 - critic/returns/mean:0.942 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.773 - critic/values/max:1.227 - critic/values/min:-1.102 - critic/vf_explained_var:-2.440 - response_length/mean:176.068 - response_length/max:767.000 - response_length/min:40.000 - response_length/clip_ratio:0.000 - prompt_length/mean:91.688 - prompt_length/max:212.000 - prompt_length/min:55.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.624 - timing_s/reward:0.701 - timing_s/old_log_prob:6.375 - timing_s/ref:6.105 - timing_s/values:27.361 - timing_s/adv:0.303 - timing_s/update_critic:97.345 - timing_s/update_actor:31.641 - timing_s/step:190.584 - timing_per_token_ms/values:0.020 - timing_per_token_ms/update_actor:0.023 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.023 - timing_per_token_ms/update_critic:0.071 - perf/total_num_tokens:1370911.000 - perf/time_per_step:190.584 - perf/throughput:899.152
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:37 - global_seqlen/min:169499.000 - global_seqlen/max:181151.000 - global_seqlen/minmax_diff:11652.000 - global_seqlen/balanced_min:174238.000 - global_seqlen/balanced_max:174238.000 - global_seqlen/mean:174238.000 - actor/entropy_loss:0.277 - critic/vf_loss:0.045 - critic/vf_clipfrac:0.193 - critic/vpred_mean:0.922 - critic/grad_norm:9.415 - perf/mfu/critic:0.083 - critic/lr:0.000 - actor/kl_loss:0.093 - actor/kl_coef:0.001 - actor/pg_loss:0.008 - actor/pg_clipfrac:0.005 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.760 - perf/mfu/actor:0.261 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.555 - perf/cpu_memory_used_gb:51.957 - actor/lr:0.000 - training/global_step:37.000 - training/epoch:5.000 - critic/score/mean:0.964 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.964 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.000 - critic/advantages/max:2.038 - critic/advantages/min:-3.159 - critic/returns/mean:0.951 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.691 - critic/values/max:1.594 - critic/values/min:-0.455 - critic/vf_explained_var:-2.413 - response_length/mean:177.821 - response_length/max:797.000 - response_length/min:39.000 - response_length/clip_ratio:0.000 - prompt_length/mean:94.426 - prompt_length/max:191.000 - prompt_length/min:53.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:22.833 - timing_s/reward:0.702 - timing_s/old_log_prob:6.503 - timing_s/ref:6.107 - timing_s/values:27.314 - timing_s/adv:0.277 - timing_s/update_critic:97.298 - timing_s/update_actor:31.131 - timing_s/step:192.577 - timing_per_token_ms/values:0.020 - timing_per_token_ms/update_actor:0.022 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.025 - timing_per_token_ms/update_critic:0.070 - perf/total_num_tokens:1393904.000 - perf/time_per_step:192.577 - perf/throughput:904.771
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:38 - global_seqlen/min:165469.000 - global_seqlen/max:176156.000 - global_seqlen/minmax_diff:10687.000 - global_seqlen/balanced_min:172692.000 - global_seqlen/balanced_max:172808.000 - global_seqlen/mean:172707.250 - actor/entropy_loss:0.291 - critic/vf_loss:0.052 - critic/vf_clipfrac:0.201 - critic/vpred_mean:0.931 - critic/grad_norm:15.703 - perf/mfu/critic:0.080 - critic/lr:0.000 - actor/kl_loss:0.110 - actor/kl_coef:0.001 - actor/pg_loss:0.005 - actor/pg_clipfrac:0.004 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.692 - perf/mfu/actor:0.248 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.555 - perf/cpu_memory_used_gb:51.999 - actor/lr:0.000 - training/global_step:38.000 - training/epoch:5.000 - critic/score/mean:0.963 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.963 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:2.343 - critic/advantages/min:-3.730 - critic/returns/mean:0.948 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.523 - critic/values/max:0.930 - critic/values/min:-0.252 - critic/vf_explained_var:-1.186 - response_length/mean:175.482 - response_length/max:1024.000 - response_length/min:34.000 - response_length/clip_ratio:0.000 - prompt_length/mean:94.373 - prompt_length/max:246.000 - prompt_length/min:57.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:24.713 - timing_s/reward:0.697 - timing_s/old_log_prob:6.403 - timing_s/ref:6.045 - timing_s/values:28.155 - timing_s/adv:0.219 - timing_s/update_critic:100.740 - timing_s/update_actor:32.528 - timing_s/step:199.601 - timing_per_token_ms/values:0.020 - timing_per_token_ms/update_actor:0.024 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.028 - timing_per_token_ms/update_critic:0.073 - perf/total_num_tokens:1381658.000 - perf/time_per_step:199.601 - perf/throughput:865.265
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:39 - global_seqlen/min:167816.000 - global_seqlen/max:179387.000 - global_seqlen/minmax_diff:11571.000 - global_seqlen/balanced_min:172787.000 - global_seqlen/balanced_max:172871.000 - global_seqlen/mean:172819.000 - actor/entropy_loss:0.292 - critic/vf_loss:0.045 - critic/vf_clipfrac:0.188 - critic/vpred_mean:0.953 - critic/grad_norm:11.735 - perf/mfu/critic:0.082 - critic/lr:0.000 - actor/kl_loss:0.114 - actor/kl_coef:0.001 - actor/pg_loss:-0.024 - actor/pg_clipfrac:0.004 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.599 - perf/mfu/actor:0.261 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.555 - perf/cpu_memory_used_gb:51.896 - actor/lr:0.000 - training/global_step:39.000 - training/epoch:5.000 - critic/score/mean:0.966 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.966 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:1.887 - critic/advantages/min:-4.020 - critic/returns/mean:0.952 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.680 - critic/values/max:2.281 - critic/values/min:-0.111 - critic/vf_explained_var:-2.289 - response_length/mean:176.618 - response_length/max:1024.000 - response_length/min:38.000 - response_length/clip_ratio:0.001 - prompt_length/mean:93.412 - prompt_length/max:185.000 - prompt_length/min:54.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:25.845 - timing_s/reward:0.694 - timing_s/old_log_prob:6.243 - timing_s/ref:6.084 - timing_s/values:28.467 - timing_s/adv:0.247 - timing_s/update_critic:98.472 - timing_s/update_actor:30.943 - timing_s/step:197.097 - timing_per_token_ms/values:0.021 - timing_per_token_ms/update_actor:0.022 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.029 - timing_per_token_ms/update_critic:0.071 - perf/total_num_tokens:1382552.000 - perf/time_per_step:197.097 - perf/throughput:876.824
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=3147479)[0m validation generation end
[36m(TaskRunner pid=3147479)[0m [prompt] system
[36m(TaskRunner pid=3147479)[0m You are a helpful assistant.
[36m(TaskRunner pid=3147479)[0m user
[36m(TaskRunner pid=3147479)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=3147479)[0m assistant
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m [response]  Janet's ducks lay 16 eggs per day.
[36m(TaskRunner pid=3147479)[0m She eats 3 for breakfast every morning, so she has \(16 - 3 = 13\) eggs left.
[36m(TaskRunner pid=3147479)[0m She bakes muffins for her friends every day with 4, so she has \(13 - 4 = 9\) eggs left.
[36m(TaskRunner pid=3147479)[0m She sells the remainder at the farmers' market daily for $2 per fresh duck egg, so she makes \(9 * 2 = 18\) dollars every day at the farmers' market.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m The answer is: $#### 18$
[36m(TaskRunner pid=3147479)[0m [ground_truth] 18
[36m(TaskRunner pid=3147479)[0m [score] 1.0
[36m(TaskRunner pid=3147479)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=3147479)[0m validation generation end
[36m(TaskRunner pid=3147479)[0m [prompt] system
[36m(TaskRunner pid=3147479)[0m You are a helpful assistant.
[36m(TaskRunner pid=3147479)[0m user
[36m(TaskRunner pid=3147479)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=3147479)[0m assistant
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m [response] Firstly, let's calculate the cost for each meal per night. 
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m Each meal costs $5, and they order 2 meals per night, so the cost for meals per night is:
[36m(TaskRunner pid=3147479)[0m 2 meals * $5 = $10
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m They also order a $5 bottle of wine per night, so the total cost per night is:
[36m(TaskRunner pid=3147479)[0m $10 (for meals) + $5 (for wine) = $15
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m They are open 2 days a week, so the total cost per week is:
[36m(TaskRunner pid=3147479)[0m $15 per night * 2 nights = $30
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m They get 6 reservations a night, so the total revenue per night is:
[36m(TaskRunner pid=3147479)[0m 6 reservations * $15 per reservation = $90
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m Therefore, the total revenue per week is:
[36m(TaskRunner pid=3147479)[0m $90 per night * 2 nights = $180
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m So, they make $180 a week. 
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m #### 180
[36m(TaskRunner pid=3147479)[0m [ground_truth] 180
[36m(TaskRunner pid=3147479)[0m [score] 1.0
[36m(TaskRunner pid=3147479)[0m step:40 - global_seqlen/min:169052.000 - global_seqlen/max:182853.000 - global_seqlen/minmax_diff:13801.000 - global_seqlen/balanced_min:172954.000 - global_seqlen/balanced_max:172984.000 - global_seqlen/mean:172971.000 - actor/entropy_loss:0.289 - critic/vf_loss:0.058 - critic/vf_clipfrac:0.184 - critic/vpred_mean:0.874 - critic/grad_norm:16.448 - perf/mfu/critic:0.080 - critic/lr:0.000 - actor/kl_loss:0.086 - actor/kl_coef:0.001 - actor/pg_loss:0.004 - actor/pg_clipfrac:0.004 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.747 - perf/mfu/actor:0.226 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.555 - perf/cpu_memory_used_gb:52.026 - actor/lr:0.000 - val-core/openai/gsm8k/reward/mean@1:0.884 - val-aux/openai/gsm8k/reward/std@1:0.000 - val-core/openai/gsm8k/reward/best@1/mean:0.884 - val-aux/openai/gsm8k/reward/worst@1/mean:0.884 - training/global_step:40.000 - training/epoch:5.000 - critic/score/mean:0.958 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.958 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:1.830 - critic/advantages/min:-2.906 - critic/returns/mean:0.943 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.781 - critic/values/max:1.461 - critic/values/min:0.000 - critic/vf_explained_var:-2.942 - response_length/mean:176.528 - response_length/max:1024.000 - response_length/min:34.000 - response_length/clip_ratio:0.001 - prompt_length/mean:93.739 - prompt_length/max:207.000 - prompt_length/min:46.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:27.281 - timing_s/reward:0.695 - timing_s/old_log_prob:6.440 - timing_s/ref:6.108 - timing_s/values:27.697 - timing_s/adv:0.258 - timing_s/update_critic:101.138 - timing_s/update_actor:35.662 - timing_s/testing:21.839 - timing_s/step:227.216 - timing_per_token_ms/values:0.020 - timing_per_token_ms/update_actor:0.026 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.030 - timing_per_token_ms/update_critic:0.073 - perf/total_num_tokens:1383768.000 - perf/time_per_step:227.216 - perf/throughput:761.262
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:41 - global_seqlen/min:171768.000 - global_seqlen/max:185924.000 - global_seqlen/minmax_diff:14156.000 - global_seqlen/balanced_min:176661.000 - global_seqlen/balanced_max:176662.000 - global_seqlen/mean:176661.875 - actor/entropy_loss:0.294 - critic/vf_loss:0.053 - critic/vf_clipfrac:0.184 - critic/vpred_mean:0.893 - critic/grad_norm:17.254 - perf/mfu/critic:0.085 - critic/lr:0.000 - actor/kl_loss:0.112 - actor/kl_coef:0.001 - actor/pg_loss:-0.004 - actor/pg_clipfrac:0.004 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.717 - perf/mfu/actor:0.251 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.555 - perf/cpu_memory_used_gb:52.066 - actor/lr:0.000 - training/global_step:41.000 - training/epoch:5.000 - critic/score/mean:0.963 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.963 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.000 - critic/advantages/max:1.928 - critic/advantages/min:-2.472 - critic/returns/mean:0.949 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.969 - critic/values/max:1.406 - critic/values/min:0.000 - critic/vf_explained_var:-4.780 - response_length/mean:182.778 - response_length/max:1024.000 - response_length/min:43.000 - response_length/clip_ratio:0.001 - prompt_length/mean:93.256 - prompt_length/max:228.000 - prompt_length/min:57.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:25.908 - timing_s/reward:0.724 - timing_s/old_log_prob:6.707 - timing_s/ref:6.236 - timing_s/values:28.318 - timing_s/adv:0.254 - timing_s/update_critic:97.380 - timing_s/update_actor:32.917 - timing_s/step:198.564 - timing_per_token_ms/values:0.020 - timing_per_token_ms/update_actor:0.023 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.028 - timing_per_token_ms/update_critic:0.069 - perf/total_num_tokens:1413295.000 - perf/time_per_step:198.564 - perf/throughput:889.697
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:42 - global_seqlen/min:170359.000 - global_seqlen/max:184112.000 - global_seqlen/minmax_diff:13753.000 - global_seqlen/balanced_min:177047.000 - global_seqlen/balanced_max:177048.000 - global_seqlen/mean:177047.250 - actor/entropy_loss:0.309 - critic/vf_loss:0.052 - critic/vf_clipfrac:0.180 - critic/vpred_mean:0.944 - critic/grad_norm:20.819 - perf/mfu/critic:0.080 - critic/lr:0.000 - actor/kl_loss:0.107 - actor/kl_coef:0.001 - actor/pg_loss:-0.031 - actor/pg_clipfrac:0.004 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.774 - perf/mfu/actor:0.261 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.555 - perf/cpu_memory_used_gb:52.099 - actor/lr:0.000 - training/global_step:42.000 - training/epoch:5.000 - critic/score/mean:0.963 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.963 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:1.990 - critic/advantages/min:-3.242 - critic/returns/mean:0.941 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.867 - critic/values/max:1.438 - critic/values/min:0.000 - critic/vf_explained_var:-2.926 - response_length/mean:182.506 - response_length/max:1024.000 - response_length/min:43.000 - response_length/clip_ratio:0.001 - prompt_length/mean:94.130 - prompt_length/max:222.000 - prompt_length/min:53.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:28.673 - timing_s/reward:0.700 - timing_s/old_log_prob:6.442 - timing_s/ref:6.256 - timing_s/values:27.307 - timing_s/adv:0.243 - timing_s/update_critic:102.765 - timing_s/update_actor:31.649 - timing_s/step:204.141 - timing_per_token_ms/values:0.019 - timing_per_token_ms/update_actor:0.022 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.031 - timing_per_token_ms/update_critic:0.073 - perf/total_num_tokens:1416378.000 - perf/time_per_step:204.141 - perf/throughput:867.279
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:43 - global_seqlen/min:167639.000 - global_seqlen/max:179085.000 - global_seqlen/minmax_diff:11446.000 - global_seqlen/balanced_min:173541.000 - global_seqlen/balanced_max:173637.000 - global_seqlen/mean:173565.500 - actor/entropy_loss:0.328 - critic/vf_loss:0.056 - critic/vf_clipfrac:0.196 - critic/vpred_mean:0.887 - critic/grad_norm:20.437 - perf/mfu/critic:0.082 - critic/lr:0.000 - actor/kl_loss:0.121 - actor/kl_coef:0.001 - actor/pg_loss:-0.005 - actor/pg_clipfrac:0.005 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.710 - perf/mfu/actor:0.249 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.555 - perf/cpu_memory_used_gb:52.071 - actor/lr:0.000 - training/global_step:43.000 - training/epoch:6.000 - critic/score/mean:0.961 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.961 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:1.952 - critic/advantages/min:-2.529 - critic/returns/mean:0.946 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.934 - critic/values/max:2.250 - critic/values/min:0.000 - critic/vf_explained_var:-3.978 - response_length/mean:177.949 - response_length/max:1024.000 - response_length/min:41.000 - response_length/clip_ratio:0.000 - prompt_length/mean:93.247 - prompt_length/max:202.000 - prompt_length/min:54.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:24.196 - timing_s/reward:0.705 - timing_s/old_log_prob:6.435 - timing_s/ref:6.035 - timing_s/values:27.173 - timing_s/adv:0.242 - timing_s/update_critic:98.424 - timing_s/update_actor:32.529 - timing_s/step:195.904 - timing_per_token_ms/values:0.020 - timing_per_token_ms/update_actor:0.023 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.027 - timing_per_token_ms/update_critic:0.071 - perf/total_num_tokens:1388524.000 - perf/time_per_step:195.904 - perf/throughput:885.973
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:44 - global_seqlen/min:164758.000 - global_seqlen/max:175641.000 - global_seqlen/minmax_diff:10883.000 - global_seqlen/balanced_min:171202.000 - global_seqlen/balanced_max:171203.000 - global_seqlen/mean:171202.875 - actor/entropy_loss:0.357 - critic/vf_loss:0.045 - critic/vf_clipfrac:0.191 - critic/vpred_mean:0.971 - critic/grad_norm:11.572 - perf/mfu/critic:0.082 - critic/lr:0.000 - actor/kl_loss:0.131 - actor/kl_coef:0.001 - actor/pg_loss:-0.013 - actor/pg_clipfrac:0.004 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.698 - perf/mfu/actor:0.245 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.555 - perf/cpu_memory_used_gb:52.023 - actor/lr:0.000 - training/global_step:44.000 - training/epoch:6.000 - critic/score/mean:0.968 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.968 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.000 - critic/advantages/max:1.945 - critic/advantages/min:-2.712 - critic/returns/mean:0.955 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.871 - critic/values/max:1.703 - critic/values/min:0.000 - critic/vf_explained_var:-4.149 - response_length/mean:174.151 - response_length/max:949.000 - response_length/min:38.000 - response_length/clip_ratio:0.000 - prompt_length/mean:93.354 - prompt_length/max:191.000 - prompt_length/min:54.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.159 - timing_s/reward:0.706 - timing_s/old_log_prob:6.220 - timing_s/ref:6.027 - timing_s/values:27.423 - timing_s/adv:0.213 - timing_s/update_critic:97.384 - timing_s/update_actor:32.620 - timing_s/step:196.853 - timing_per_token_ms/values:0.020 - timing_per_token_ms/update_actor:0.024 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.029 - timing_per_token_ms/update_critic:0.071 - perf/total_num_tokens:1369623.000 - perf/time_per_step:196.853 - perf/throughput:869.700
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=3147479)[0m validation generation end
[36m(TaskRunner pid=3147479)[0m [prompt] system
[36m(TaskRunner pid=3147479)[0m You are a helpful assistant.
[36m(TaskRunner pid=3147479)[0m user
[36m(TaskRunner pid=3147479)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=3147479)[0m assistant
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m [response]  Janet's ducks lay 16 eggs per day.
[36m(TaskRunner pid=3147479)[0m She eats 3 for breakfast every morning, so she has \( 16 - 3 = 13 \) eggs left.
[36m(TaskRunner pid=3147479)[0m She bakes muffins for her friends every day with 4, so she has \( 13 - 4 = 9 \) eggs left.
[36m(TaskRunner pid=3147479)[0m She sells the remainder at the farmers' market daily for $2 per fresh duck egg, so she makes \( 9 * 2 = 18 \) dollars every day at the farmers' market.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m The answer is: $#### 18$
[36m(TaskRunner pid=3147479)[0m [ground_truth] 18
[36m(TaskRunner pid=3147479)[0m [score] 1.0
[36m(TaskRunner pid=3147479)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=3147479)[0m validation generation end
[36m(TaskRunner pid=3147479)[0m [prompt] system
[36m(TaskRunner pid=3147479)[0m You are a helpful assistant.
[36m(TaskRunner pid=3147479)[0m user
[36m(TaskRunner pid=3147479)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=3147479)[0m assistant
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m [response]  First, let's calculate the cost of meals and wine for one night:
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m - They order 2 meals that cost $5 each, so the cost of meals is 2 * $5 = $10.
[36m(TaskRunner pid=3147479)[0m - They also order a $5 bottle of wine.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m So, the total cost for one night is $10 (meals) + $5 (wine) = $15.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m Tom's restaurant gets 6 reservations a night, so the total cost for one night is 6 * $15 = $90.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m They are open 2 days a week, so the total cost for a week is 2 * $90 = $180.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m Therefore, they make $180 a week.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m #### 180
[36m(TaskRunner pid=3147479)[0m [ground_truth] 180
[36m(TaskRunner pid=3147479)[0m [score] 1.0
[36m(TaskRunner pid=3147479)[0m step:45 - global_seqlen/min:166701.000 - global_seqlen/max:185811.000 - global_seqlen/minmax_diff:19110.000 - global_seqlen/balanced_min:174159.000 - global_seqlen/balanced_max:174160.000 - global_seqlen/mean:174159.625 - actor/entropy_loss:0.379 - critic/vf_loss:0.052 - critic/vf_clipfrac:0.164 - critic/vpred_mean:0.873 - critic/grad_norm:12.634 - perf/mfu/critic:0.084 - critic/lr:0.000 - actor/kl_loss:0.153 - actor/kl_coef:0.001 - actor/pg_loss:0.056 - actor/pg_clipfrac:0.004 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.757 - perf/mfu/actor:0.242 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.555 - perf/cpu_memory_used_gb:51.998 - actor/lr:0.000 - val-core/openai/gsm8k/reward/mean@1:0.873 - val-aux/openai/gsm8k/reward/std@1:0.000 - val-core/openai/gsm8k/reward/best@1/mean:0.873 - val-aux/openai/gsm8k/reward/worst@1/mean:0.873 - training/global_step:45.000 - training/epoch:6.000 - critic/score/mean:0.942 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.942 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:2.387 - critic/advantages/min:-3.384 - critic/returns/mean:0.919 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.797 - critic/values/max:1.852 - critic/values/min:-0.228 - critic/vf_explained_var:-1.878 - response_length/mean:178.185 - response_length/max:1024.000 - response_length/min:34.000 - response_length/clip_ratio:0.001 - prompt_length/mean:93.939 - prompt_length/max:228.000 - prompt_length/min:46.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.654 - timing_s/reward:0.708 - timing_s/old_log_prob:6.512 - timing_s/ref:6.146 - timing_s/values:27.287 - timing_s/adv:0.218 - timing_s/update_critic:97.117 - timing_s/update_actor:33.538 - timing_s/testing:18.197 - timing_s/step:216.489 - timing_per_token_ms/values:0.020 - timing_per_token_ms/update_actor:0.024 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.029 - timing_per_token_ms/update_critic:0.070 - perf/total_num_tokens:1393277.000 - perf/time_per_step:216.489 - perf/throughput:804.472
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:46 - global_seqlen/min:166211.000 - global_seqlen/max:178993.000 - global_seqlen/minmax_diff:12782.000 - global_seqlen/balanced_min:171869.000 - global_seqlen/balanced_max:171957.000 - global_seqlen/mean:171880.750 - actor/entropy_loss:0.381 - critic/vf_loss:0.052 - critic/vf_clipfrac:0.183 - critic/vpred_mean:0.947 - critic/grad_norm:20.312 - perf/mfu/critic:0.081 - critic/lr:0.000 - actor/kl_loss:0.158 - actor/kl_coef:0.001 - actor/pg_loss:-0.019 - actor/pg_clipfrac:0.004 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.885 - perf/mfu/actor:0.251 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.555 - perf/cpu_memory_used_gb:52.089 - actor/lr:0.000 - training/global_step:46.000 - training/epoch:6.000 - critic/score/mean:0.963 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.963 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.000 - critic/advantages/max:3.168 - critic/advantages/min:-3.212 - critic/returns/mean:0.949 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.832 - critic/values/max:2.125 - critic/values/min:-0.590 - critic/vf_explained_var:-3.485 - response_length/mean:175.036 - response_length/max:1024.000 - response_length/min:31.000 - response_length/clip_ratio:0.000 - prompt_length/mean:93.527 - prompt_length/max:246.000 - prompt_length/min:54.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:23.640 - timing_s/reward:0.693 - timing_s/old_log_prob:6.208 - timing_s/ref:6.079 - timing_s/values:27.286 - timing_s/adv:0.255 - timing_s/update_critic:98.421 - timing_s/update_actor:32.085 - timing_s/step:194.782 - timing_per_token_ms/values:0.020 - timing_per_token_ms/update_actor:0.023 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.026 - timing_per_token_ms/update_critic:0.072 - perf/total_num_tokens:1375046.000 - perf/time_per_step:194.782 - perf/throughput:882.424
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:47 - global_seqlen/min:168191.000 - global_seqlen/max:179483.000 - global_seqlen/minmax_diff:11292.000 - global_seqlen/balanced_min:174712.000 - global_seqlen/balanced_max:174713.000 - global_seqlen/mean:174712.500 - actor/entropy_loss:0.378 - critic/vf_loss:0.050 - critic/vf_clipfrac:0.177 - critic/vpred_mean:0.920 - critic/grad_norm:13.925 - perf/mfu/critic:0.081 - critic/lr:0.000 - actor/kl_loss:0.119 - actor/kl_coef:0.001 - actor/pg_loss:0.016 - actor/pg_clipfrac:0.004 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.863 - perf/mfu/actor:0.240 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.555 - perf/cpu_memory_used_gb:52.235 - actor/lr:0.000 - training/global_step:47.000 - training/epoch:6.000 - critic/score/mean:0.954 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.954 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:1.974 - critic/advantages/min:-2.450 - critic/returns/mean:0.928 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.977 - critic/values/max:1.883 - critic/values/min:0.000 - critic/vf_explained_var:-3.226 - response_length/mean:179.168 - response_length/max:1024.000 - response_length/min:39.000 - response_length/clip_ratio:0.001 - prompt_length/mean:93.820 - prompt_length/max:222.000 - prompt_length/min:53.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.454 - timing_s/reward:0.700 - timing_s/old_log_prob:6.421 - timing_s/ref:6.123 - timing_s/values:27.284 - timing_s/adv:0.245 - timing_s/update_critic:100.344 - timing_s/update_actor:34.038 - timing_s/step:201.964 - timing_per_token_ms/values:0.020 - timing_per_token_ms/update_actor:0.024 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.029 - timing_per_token_ms/update_critic:0.072 - perf/total_num_tokens:1397700.000 - perf/time_per_step:201.964 - perf/throughput:865.067
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:48 - global_seqlen/min:172040.000 - global_seqlen/max:186136.000 - global_seqlen/minmax_diff:14096.000 - global_seqlen/balanced_min:177645.000 - global_seqlen/balanced_max:177772.000 - global_seqlen/mean:177692.625 - actor/entropy_loss:0.360 - critic/vf_loss:0.054 - critic/vf_clipfrac:0.167 - critic/vpred_mean:0.881 - critic/grad_norm:16.536 - perf/mfu/critic:0.081 - critic/lr:0.000 - actor/kl_loss:0.129 - actor/kl_coef:0.001 - actor/pg_loss:-0.032 - actor/pg_clipfrac:0.005 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.789 - perf/mfu/actor:0.244 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.555 - perf/cpu_memory_used_gb:52.332 - actor/lr:0.000 - training/global_step:48.000 - training/epoch:6.000 - critic/score/mean:0.957 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.957 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:1.988 - critic/advantages/min:-3.090 - critic/returns/mean:0.940 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.875 - critic/values/max:1.633 - critic/values/min:0.000 - critic/vf_explained_var:-2.951 - response_length/mean:184.144 - response_length/max:1024.000 - response_length/min:39.000 - response_length/clip_ratio:0.001 - prompt_length/mean:93.501 - prompt_length/max:186.000 - prompt_length/min:56.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.265 - timing_s/reward:0.693 - timing_s/old_log_prob:6.644 - timing_s/ref:6.256 - timing_s/values:27.239 - timing_s/adv:0.258 - timing_s/update_critic:102.011 - timing_s/update_actor:34.033 - timing_s/step:203.500 - timing_per_token_ms/values:0.019 - timing_per_token_ms/update_actor:0.024 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.028 - timing_per_token_ms/update_critic:0.072 - perf/total_num_tokens:1421541.000 - perf/time_per_step:203.500 - perf/throughput:873.182
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:49 - global_seqlen/min:169906.000 - global_seqlen/max:184271.000 - global_seqlen/minmax_diff:14365.000 - global_seqlen/balanced_min:175763.000 - global_seqlen/balanced_max:175783.000 - global_seqlen/mean:175780.125 - actor/entropy_loss:0.363 - critic/vf_loss:0.046 - critic/vf_clipfrac:0.174 - critic/vpred_mean:0.938 - critic/grad_norm:14.247 - perf/mfu/critic:0.082 - critic/lr:0.000 - actor/kl_loss:0.157 - actor/kl_coef:0.001 - actor/pg_loss:0.016 - actor/pg_clipfrac:0.005 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.787 - perf/mfu/actor:0.239 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.555 - perf/cpu_memory_used_gb:52.267 - actor/lr:0.000 - training/global_step:49.000 - training/epoch:6.000 - critic/score/mean:0.958 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.958 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.000 - critic/advantages/max:1.886 - critic/advantages/min:-3.106 - critic/returns/mean:0.939 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.691 - critic/values/max:1.609 - critic/values/min:-0.178 - critic/vf_explained_var:-1.795 - response_length/mean:180.829 - response_length/max:1024.000 - response_length/min:47.000 - response_length/clip_ratio:0.001 - prompt_length/mean:93.827 - prompt_length/max:212.000 - prompt_length/min:55.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:27.000 - timing_s/reward:0.703 - timing_s/old_log_prob:6.372 - timing_s/ref:6.115 - timing_s/values:27.924 - timing_s/adv:0.244 - timing_s/update_critic:100.169 - timing_s/update_actor:34.368 - timing_s/step:202.989 - timing_per_token_ms/values:0.020 - timing_per_token_ms/update_actor:0.024 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.029 - timing_per_token_ms/update_critic:0.071 - perf/total_num_tokens:1406241.000 - perf/time_per_step:202.989 - perf/throughput:865.957
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=3147479)[0m validation generation end
[36m(TaskRunner pid=3147479)[0m [prompt] system
[36m(TaskRunner pid=3147479)[0m You are a helpful assistant.
[36m(TaskRunner pid=3147479)[0m user
[36m(TaskRunner pid=3147479)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=3147479)[0m assistant
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m [response]  Janet's ducks lay 16 eggs per day.
[36m(TaskRunner pid=3147479)[0m She eats 3 for breakfast every morning, so she has \( 16 - 3 = 13 \) eggs left.
[36m(TaskRunner pid=3147479)[0m She bakes muffins for her friends every day with 4, so she has \( 13 - 4 = 9 \) eggs left.
[36m(TaskRunner pid=3147479)[0m She sells the remainder at the farmers' market daily for $2 per fresh duck egg, so she makes \( 9 * 2 = 18 \) dollars every day at the farmers' market.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m The answer is: $#### 18$
[36m(TaskRunner pid=3147479)[0m [ground_truth] 18
[36m(TaskRunner pid=3147479)[0m [score] 1.0
[36m(TaskRunner pid=3147479)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=3147479)[0m validation generation end
[36m(TaskRunner pid=3147479)[0m [prompt] system
[36m(TaskRunner pid=3147479)[0m You are a helpful assistant.
[36m(TaskRunner pid=3147479)[0m user
[36m(TaskRunner pid=3147479)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=3147479)[0m assistant
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m [response]  First, let's calculate the cost of meals and wine for one night:
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m Each night, Tom's restaurant gets 6 reservations, and they order 2 meals per reservation, so they order \(6 * 2 = 12\) meals.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m Each meal costs $5, so the cost of meals per night is \(12 * $5 = $60\).
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m They also order a $5 bottle of wine per night, so the total cost per night is \( $60 + $5 = $65\).
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m They are open 2 days a week, so the total cost per week is \( $65 * 2 = $130\).
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m However, we also need to calculate their earnings per week. Since they make $65 per night and are open 2 nights a week, their total earnings per week is \( $65 * 2 = $130\).
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m But we also need to consider their profit, not just their earnings. Since their total cost per week is $130, and they make $130 per week, their profit per week is \( $130 - $130 = $0\).
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m However, this calculation assumes that the cost of meals and wine is the only cost they have, which is not correct. They also have other costs such as labor, utilities, and other expenses that are not included in this calculation. 
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m If we assume that the cost of meals and wine is the only cost they have, then their profit per week is indeed $0. But in reality, they would have a positive profit if their earnings exceed their total costs.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m Let's correct this and calculate their actual profit per week:
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m If they make $130 per week and their total costs per week are also $130, then their profit per week is \( $130 - $130 = $0\).
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m However, this calculation is based on the assumption that the cost of meals and wine is the only cost they have, which is not correct. In reality, they would have a positive profit if their earnings exceed their total costs.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m If we assume that the cost of meals and wine is the only cost they have, then their profit per week is indeed $0. But in reality, they would have a positive profit if their earnings exceed their total costs.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m Let's correct this and calculate their actual profit per week:
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m If they make $130 per week and their total costs per week are less than $130, then they would have a positive profit. The exact profit would be their earnings minus their total costs.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m Since we don't have the exact breakdown of their other costs, we can't calculate the exact profit. But based on the information given, we can only conclude that their profit per week is $0 if we only consider the cost of meals and wine.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m #### 0
[36m(TaskRunner pid=3147479)[0m [ground_truth] 180
[36m(TaskRunner pid=3147479)[0m [score] 0.0
[36m(TaskRunner pid=3147479)[0m step:50 - global_seqlen/min:172855.000 - global_seqlen/max:179935.000 - global_seqlen/minmax_diff:7080.000 - global_seqlen/balanced_min:176195.000 - global_seqlen/balanced_max:176196.000 - global_seqlen/mean:176195.500 - actor/entropy_loss:0.385 - critic/vf_loss:0.049 - critic/vf_clipfrac:0.179 - critic/vpred_mean:0.981 - critic/grad_norm:19.810 - perf/mfu/critic:0.083 - critic/lr:0.000 - actor/kl_loss:0.149 - actor/kl_coef:0.001 - actor/pg_loss:0.002 - actor/pg_clipfrac:0.004 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.740 - perf/mfu/actor:0.247 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.555 - perf/cpu_memory_used_gb:52.019 - actor/lr:0.000 - val-core/openai/gsm8k/reward/mean@1:0.884 - val-aux/openai/gsm8k/reward/std@1:0.000 - val-core/openai/gsm8k/reward/best@1/mean:0.884 - val-aux/openai/gsm8k/reward/worst@1/mean:0.884 - training/global_step:50.000 - training/epoch:7.000 - critic/score/mean:0.951 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.951 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:2.773 - critic/advantages/min:-3.827 - critic/returns/mean:0.933 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.664 - critic/values/max:1.234 - critic/values/min:-0.459 - critic/vf_explained_var:-1.352 - response_length/mean:181.819 - response_length/max:1024.000 - response_length/min:38.000 - response_length/clip_ratio:0.000 - prompt_length/mean:93.486 - prompt_length/max:228.000 - prompt_length/min:46.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:24.607 - timing_s/reward:0.703 - timing_s/old_log_prob:6.485 - timing_s/ref:6.209 - timing_s/values:27.242 - timing_s/adv:0.271 - timing_s/update_critic:99.554 - timing_s/update_actor:33.559 - timing_s/testing:27.982 - timing_s/step:226.766 - timing_per_token_ms/values:0.019 - timing_per_token_ms/update_actor:0.024 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.026 - timing_per_token_ms/update_critic:0.071 - perf/total_num_tokens:1409564.000 - perf/time_per_step:226.766 - perf/throughput:776.993
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:51 - global_seqlen/min:171545.000 - global_seqlen/max:180228.000 - global_seqlen/minmax_diff:8683.000 - global_seqlen/balanced_min:176359.000 - global_seqlen/balanced_max:176436.000 - global_seqlen/mean:176406.875 - actor/entropy_loss:0.392 - critic/vf_loss:0.039 - critic/vf_clipfrac:0.180 - critic/vpred_mean:0.893 - critic/grad_norm:7.276 - perf/mfu/critic:0.084 - critic/lr:0.000 - actor/kl_loss:0.133 - actor/kl_coef:0.001 - actor/pg_loss:-0.018 - actor/pg_clipfrac:0.004 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.797 - perf/mfu/actor:0.255 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.555 - perf/cpu_memory_used_gb:52.158 - actor/lr:0.000 - training/global_step:51.000 - training/epoch:7.000 - critic/score/mean:0.956 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.956 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.000 - critic/advantages/max:1.905 - critic/advantages/min:-3.549 - critic/returns/mean:0.937 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.703 - critic/values/max:1.891 - critic/values/min:-0.465 - critic/vf_explained_var:-1.738 - response_length/mean:182.673 - response_length/max:1024.000 - response_length/min:38.000 - response_length/clip_ratio:0.001 - prompt_length/mean:92.963 - prompt_length/max:207.000 - prompt_length/min:53.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:24.115 - timing_s/reward:0.711 - timing_s/old_log_prob:6.452 - timing_s/ref:6.230 - timing_s/values:27.987 - timing_s/adv:0.244 - timing_s/update_critic:98.043 - timing_s/update_actor:32.250 - timing_s/step:196.155 - timing_per_token_ms/values:0.020 - timing_per_token_ms/update_actor:0.023 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.026 - timing_per_token_ms/update_critic:0.069 - perf/total_num_tokens:1411255.000 - perf/time_per_step:196.155 - perf/throughput:899.322
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:52 - global_seqlen/min:169907.000 - global_seqlen/max:185083.000 - global_seqlen/minmax_diff:15176.000 - global_seqlen/balanced_min:179447.000 - global_seqlen/balanced_max:179447.000 - global_seqlen/mean:179447.000 - actor/entropy_loss:0.400 - critic/vf_loss:0.045 - critic/vf_clipfrac:0.162 - critic/vpred_mean:0.917 - critic/grad_norm:7.424 - perf/mfu/critic:0.083 - critic/lr:0.000 - actor/kl_loss:0.149 - actor/kl_coef:0.001 - actor/pg_loss:0.031 - actor/pg_clipfrac:0.005 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.676 - perf/mfu/actor:0.249 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.555 - perf/cpu_memory_used_gb:52.235 - actor/lr:0.000 - training/global_step:52.000 - training/epoch:7.000 - critic/score/mean:0.961 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.961 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.000 - critic/advantages/max:2.043 - critic/advantages/min:-3.451 - critic/returns/mean:0.941 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.727 - critic/values/max:1.711 - critic/values/min:-0.051 - critic/vf_explained_var:-1.996 - response_length/mean:186.508 - response_length/max:1024.000 - response_length/min:42.000 - response_length/clip_ratio:0.001 - prompt_length/mean:93.878 - prompt_length/max:205.000 - prompt_length/min:54.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:27.375 - timing_s/reward:0.736 - timing_s/old_log_prob:6.509 - timing_s/ref:6.555 - timing_s/values:27.412 - timing_s/adv:0.232 - timing_s/update_critic:100.274 - timing_s/update_actor:33.703 - timing_s/step:202.899 - timing_per_token_ms/values:0.019 - timing_per_token_ms/update_actor:0.023 - timing_per_token_ms/ref:0.005 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.029 - timing_per_token_ms/update_critic:0.070 - perf/total_num_tokens:1435576.000 - perf/time_per_step:202.899 - perf/throughput:884.415
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:53 - global_seqlen/min:174358.000 - global_seqlen/max:188414.000 - global_seqlen/minmax_diff:14056.000 - global_seqlen/balanced_min:181354.000 - global_seqlen/balanced_max:181354.000 - global_seqlen/mean:181354.000 - actor/entropy_loss:0.406 - critic/vf_loss:0.050 - critic/vf_clipfrac:0.171 - critic/vpred_mean:0.918 - critic/grad_norm:12.581 - perf/mfu/critic:0.086 - critic/lr:0.000 - actor/kl_loss:0.136 - actor/kl_coef:0.001 - actor/pg_loss:0.015 - actor/pg_clipfrac:0.004 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.690 - perf/mfu/actor:0.258 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.555 - perf/cpu_memory_used_gb:52.251 - actor/lr:0.000 - training/global_step:53.000 - training/epoch:7.000 - critic/score/mean:0.960 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.960 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:2.368 - critic/advantages/min:-3.451 - critic/returns/mean:0.944 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.668 - critic/values/max:1.125 - critic/values/min:-0.355 - critic/vf_explained_var:-1.691 - response_length/mean:189.529 - response_length/max:1024.000 - response_length/min:48.000 - response_length/clip_ratio:0.001 - prompt_length/mean:93.837 - prompt_length/max:246.000 - prompt_length/min:57.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:25.973 - timing_s/reward:0.712 - timing_s/old_log_prob:6.609 - timing_s/ref:6.490 - timing_s/values:27.382 - timing_s/adv:0.241 - timing_s/update_critic:97.988 - timing_s/update_actor:32.844 - timing_s/step:198.342 - timing_per_token_ms/values:0.019 - timing_per_token_ms/update_actor:0.023 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.027 - timing_per_token_ms/update_critic:0.068 - perf/total_num_tokens:1450832.000 - perf/time_per_step:198.342 - perf/throughput:914.352
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:54 - global_seqlen/min:176179.000 - global_seqlen/max:192282.000 - global_seqlen/minmax_diff:16103.000 - global_seqlen/balanced_min:182614.000 - global_seqlen/balanced_max:182614.000 - global_seqlen/mean:182614.000 - actor/entropy_loss:0.402 - critic/vf_loss:0.040 - critic/vf_clipfrac:0.177 - critic/vpred_mean:0.904 - critic/grad_norm:10.425 - perf/mfu/critic:0.085 - critic/lr:0.000 - actor/kl_loss:0.147 - actor/kl_coef:0.001 - actor/pg_loss:-0.031 - actor/pg_clipfrac:0.004 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.771 - perf/mfu/actor:0.247 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.555 - perf/cpu_memory_used_gb:52.325 - actor/lr:0.000 - training/global_step:54.000 - training/epoch:7.000 - critic/score/mean:0.960 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.960 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:2.007 - critic/advantages/min:-3.060 - critic/returns/mean:0.941 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.789 - critic/values/max:1.852 - critic/values/min:-0.271 - critic/vf_explained_var:-2.205 - response_length/mean:190.651 - response_length/max:1024.000 - response_length/min:10.000 - response_length/clip_ratio:0.001 - prompt_length/mean:94.684 - prompt_length/max:180.000 - prompt_length/min:52.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.991 - timing_s/reward:0.714 - timing_s/old_log_prob:6.680 - timing_s/ref:6.438 - timing_s/values:27.243 - timing_s/adv:0.228 - timing_s/update_critic:100.063 - timing_s/update_actor:34.516 - timing_s/step:202.979 - timing_per_token_ms/values:0.019 - timing_per_token_ms/update_actor:0.024 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.028 - timing_per_token_ms/update_critic:0.068 - perf/total_num_tokens:1460912.000 - perf/time_per_step:202.979 - perf/throughput:899.670
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=3147479)[0m validation generation end
[36m(TaskRunner pid=3147479)[0m [prompt] system
[36m(TaskRunner pid=3147479)[0m You are a helpful assistant.
[36m(TaskRunner pid=3147479)[0m user
[36m(TaskRunner pid=3147479)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=3147479)[0m assistant
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m [response]  Janet's ducks lay 16 eggs per day.
[36m(TaskRunner pid=3147479)[0m She eats 3 for breakfast every morning, so she uses 3 eggs.
[36m(TaskRunner pid=3147479)[0m She bakes muffins for her friends every day with 4 eggs, so she uses 4 eggs.
[36m(TaskRunner pid=3147479)[0m Therefore, she uses a total of \( 3 + 4 = 7 \) eggs every day.
[36m(TaskRunner pid=3147479)[0m So, she has \( 16 - 7 = 9 \) eggs left to sell at the farmers' market.
[36m(TaskRunner pid=3147479)[0m She sells each fresh duck egg for $2, so she makes \( 9 * 2 = 18 \) dollars every day at the farmers' market.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m The answer is: $#### 18$
[36m(TaskRunner pid=3147479)[0m [ground_truth] 18
[36m(TaskRunner pid=3147479)[0m [score] 1.0
[36m(TaskRunner pid=3147479)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=3147479)[0m validation generation end
[36m(TaskRunner pid=3147479)[0m [prompt] system
[36m(TaskRunner pid=3147479)[0m You are a helpful assistant.
[36m(TaskRunner pid=3147479)[0m user
[36m(TaskRunner pid=3147479)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=3147479)[0m assistant
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m [response] Let's break this down step by step:
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m Step 1: Calculate the number of meals Tom's restaurant needs to prepare per night.
[36m(TaskRunner pid=3147479)[0m Since they get 6 reservations a night and they need to prepare 2 meals per reservation, they need to prepare \( 6 * 2 = 12 \) meals per night.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m Step 2: Calculate the cost of the meals per night.
[36m(TaskRunner pid=3147479)[0m Each meal costs $5, so the cost of the meals per night is \( 12 * $5 = $60 \).
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m Step 3: Add the cost of the wine per night.
[36m(TaskRunner pid=3147479)[0m The wine costs $5 per bottle, so the total cost per night is \( $60 + $5 = $65 \).
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m Step 4: Calculate the total earnings per night.
[36m(TaskRunner pid=3147479)[0m Since they are open 2 days a week, their total earnings per week are \( 2 * $65 = $130 \).
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m So, Tom's restaurant makes $130 a week. 
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m #### 130
[36m(TaskRunner pid=3147479)[0m [ground_truth] 180
[36m(TaskRunner pid=3147479)[0m [score] 0.0
[36m(TaskRunner pid=3147479)[0m step:55 - global_seqlen/min:175962.000 - global_seqlen/max:188112.000 - global_seqlen/minmax_diff:12150.000 - global_seqlen/balanced_min:182017.000 - global_seqlen/balanced_max:182180.000 - global_seqlen/mean:182037.375 - actor/entropy_loss:0.434 - critic/vf_loss:0.046 - critic/vf_clipfrac:0.174 - critic/vpred_mean:0.910 - critic/grad_norm:9.850 - perf/mfu/critic:0.083 - critic/lr:0.000 - actor/kl_loss:0.167 - actor/kl_coef:0.001 - actor/pg_loss:0.052 - actor/pg_clipfrac:0.004 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.719 - perf/mfu/actor:0.238 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.555 - perf/cpu_memory_used_gb:52.406 - actor/lr:0.000 - val-core/openai/gsm8k/reward/mean@1:0.889 - val-aux/openai/gsm8k/reward/std@1:0.000 - val-core/openai/gsm8k/reward/best@1/mean:0.889 - val-aux/openai/gsm8k/reward/worst@1/mean:0.889 - training/global_step:55.000 - training/epoch:7.000 - critic/score/mean:0.965 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.965 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:1.956 - critic/advantages/min:-2.771 - critic/returns/mean:0.952 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.816 - critic/values/max:1.344 - critic/values/min:-0.076 - critic/vf_explained_var:-3.239 - response_length/mean:191.154 - response_length/max:1024.000 - response_length/min:14.000 - response_length/clip_ratio:0.000 - prompt_length/mean:93.279 - prompt_length/max:202.000 - prompt_length/min:54.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:25.987 - timing_s/reward:0.700 - timing_s/old_log_prob:6.721 - timing_s/ref:6.467 - timing_s/values:28.222 - timing_s/adv:0.245 - timing_s/update_critic:101.676 - timing_s/update_actor:35.727 - timing_s/testing:31.683 - timing_s/step:237.521 - timing_per_token_ms/values:0.019 - timing_per_token_ms/update_actor:0.025 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.027 - timing_per_token_ms/update_critic:0.070 - perf/total_num_tokens:1456299.000 - perf/time_per_step:237.521 - perf/throughput:766.404
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:56 - global_seqlen/min:180141.000 - global_seqlen/max:191370.000 - global_seqlen/minmax_diff:11229.000 - global_seqlen/balanced_min:185162.000 - global_seqlen/balanced_max:185162.000 - global_seqlen/mean:185162.000 - actor/entropy_loss:0.434 - critic/vf_loss:0.040 - critic/vf_clipfrac:0.168 - critic/vpred_mean:0.894 - critic/grad_norm:9.764 - perf/mfu/critic:0.088 - critic/lr:0.000 - actor/kl_loss:0.159 - actor/kl_coef:0.001 - actor/pg_loss:-0.016 - actor/pg_clipfrac:0.004 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.766 - perf/mfu/actor:0.266 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.555 - perf/cpu_memory_used_gb:52.391 - actor/lr:0.000 - training/global_step:56.000 - training/epoch:7.000 - critic/score/mean:0.964 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.964 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:2.032 - critic/advantages/min:-3.255 - critic/returns/mean:0.948 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.645 - critic/values/max:1.625 - critic/values/min:-0.049 - critic/vf_explained_var:-1.729 - response_length/mean:195.976 - response_length/max:1024.000 - response_length/min:47.000 - response_length/clip_ratio:0.001 - prompt_length/mean:93.340 - prompt_length/max:222.000 - prompt_length/min:53.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:23.849 - timing_s/reward:0.727 - timing_s/old_log_prob:6.669 - timing_s/ref:6.551 - timing_s/values:28.077 - timing_s/adv:0.257 - timing_s/update_critic:98.086 - timing_s/update_actor:32.568 - timing_s/step:196.921 - timing_per_token_ms/values:0.019 - timing_per_token_ms/update_actor:0.022 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.024 - timing_per_token_ms/update_critic:0.066 - perf/total_num_tokens:1481296.000 - perf/time_per_step:196.921 - perf/throughput:940.286
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:57 - global_seqlen/min:174494.000 - global_seqlen/max:191667.000 - global_seqlen/minmax_diff:17173.000 - global_seqlen/balanced_min:184921.000 - global_seqlen/balanced_max:184960.000 - global_seqlen/mean:184945.000 - actor/entropy_loss:0.468 - critic/vf_loss:0.042 - critic/vf_clipfrac:0.176 - critic/vpred_mean:0.907 - critic/grad_norm:6.385 - perf/mfu/critic:0.088 - critic/lr:0.000 - actor/kl_loss:0.173 - actor/kl_coef:0.001 - actor/pg_loss:0.021 - actor/pg_clipfrac:0.005 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.730 - perf/mfu/actor:0.265 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.555 - perf/cpu_memory_used_gb:52.251 - actor/lr:0.000 - training/global_step:57.000 - training/epoch:8.000 - critic/score/mean:0.962 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.962 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.000 - critic/advantages/max:2.742 - critic/advantages/min:-3.170 - critic/returns/mean:0.945 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.773 - critic/values/max:1.320 - critic/values/min:-0.379 - critic/vf_explained_var:-2.377 - response_length/mean:194.984 - response_length/max:1024.000 - response_length/min:47.000 - response_length/clip_ratio:0.001 - prompt_length/mean:93.992 - prompt_length/max:212.000 - prompt_length/min:52.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.155 - timing_s/reward:0.716 - timing_s/old_log_prob:6.678 - timing_s/ref:6.542 - timing_s/values:27.824 - timing_s/adv:0.285 - timing_s/update_critic:97.885 - timing_s/update_actor:32.599 - timing_s/step:198.826 - timing_per_token_ms/values:0.019 - timing_per_token_ms/update_actor:0.022 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.026 - timing_per_token_ms/update_critic:0.066 - perf/total_num_tokens:1479560.000 - perf/time_per_step:198.826 - perf/throughput:930.183
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:58 - global_seqlen/min:183301.000 - global_seqlen/max:195748.000 - global_seqlen/minmax_diff:12447.000 - global_seqlen/balanced_min:188001.000 - global_seqlen/balanced_max:188052.000 - global_seqlen/mean:188032.875 - actor/entropy_loss:0.492 - critic/vf_loss:0.035 - critic/vf_clipfrac:0.163 - critic/vpred_mean:0.939 - critic/grad_norm:6.322 - perf/mfu/critic:0.088 - critic/lr:0.000 - actor/kl_loss:0.159 - actor/kl_coef:0.001 - actor/pg_loss:0.013 - actor/pg_clipfrac:0.005 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.729 - perf/mfu/actor:0.270 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.555 - perf/cpu_memory_used_gb:52.271 - actor/lr:0.000 - training/global_step:58.000 - training/epoch:8.000 - critic/score/mean:0.959 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.959 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:1.986 - critic/advantages/min:-3.053 - critic/returns/mean:0.943 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.727 - critic/values/max:1.680 - critic/values/min:-0.207 - critic/vf_explained_var:-1.885 - response_length/mean:199.729 - response_length/max:1024.000 - response_length/min:47.000 - response_length/clip_ratio:0.001 - prompt_length/mean:94.072 - prompt_length/max:222.000 - prompt_length/min:57.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:23.892 - timing_s/reward:0.740 - timing_s/old_log_prob:6.907 - timing_s/ref:6.727 - timing_s/values:27.358 - timing_s/adv:0.240 - timing_s/update_critic:100.029 - timing_s/update_actor:32.612 - timing_s/step:198.616 - timing_per_token_ms/values:0.018 - timing_per_token_ms/update_actor:0.022 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.023 - timing_per_token_ms/update_critic:0.066 - perf/total_num_tokens:1504263.000 - perf/time_per_step:198.616 - perf/throughput:946.718
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:59 - global_seqlen/min:182626.000 - global_seqlen/max:192790.000 - global_seqlen/minmax_diff:10164.000 - global_seqlen/balanced_min:187002.000 - global_seqlen/balanced_max:187003.000 - global_seqlen/mean:187002.750 - actor/entropy_loss:0.485 - critic/vf_loss:0.039 - critic/vf_clipfrac:0.168 - critic/vpred_mean:0.904 - critic/grad_norm:9.465 - perf/mfu/critic:0.088 - critic/lr:0.000 - actor/kl_loss:0.179 - actor/kl_coef:0.001 - actor/pg_loss:-0.000 - actor/pg_clipfrac:0.005 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.735 - perf/mfu/actor:0.269 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.555 - perf/cpu_memory_used_gb:52.390 - actor/lr:0.000 - training/global_step:59.000 - training/epoch:8.000 - critic/score/mean:0.960 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.960 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:2.761 - critic/advantages/min:-3.021 - critic/returns/mean:0.944 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.734 - critic/values/max:1.086 - critic/values/min:-0.311 - critic/vf_explained_var:-2.024 - response_length/mean:198.996 - response_length/max:1024.000 - response_length/min:40.000 - response_length/clip_ratio:0.001 - prompt_length/mean:93.195 - prompt_length/max:246.000 - prompt_length/min:53.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:25.849 - timing_s/reward:0.731 - timing_s/old_log_prob:6.630 - timing_s/ref:6.570 - timing_s/values:29.101 - timing_s/adv:0.255 - timing_s/update_critic:99.097 - timing_s/update_actor:32.495 - timing_s/step:200.825 - timing_per_token_ms/values:0.019 - timing_per_token_ms/update_actor:0.022 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.025 - timing_per_token_ms/update_critic:0.066 - perf/total_num_tokens:1496022.000 - perf/time_per_step:200.825 - perf/throughput:931.171
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=3147479)[0m validation generation end
[36m(TaskRunner pid=3147479)[0m [prompt] system
[36m(TaskRunner pid=3147479)[0m You are a helpful assistant.
[36m(TaskRunner pid=3147479)[0m user
[36m(TaskRunner pid=3147479)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=3147479)[0m assistant
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m [response]  Janet's ducks lay 16 eggs per day.
[36m(TaskRunner pid=3147479)[0m She eats 3 for breakfast every morning, so she uses 3 eggs.
[36m(TaskRunner pid=3147479)[0m She bakes muffins for her friends every day with 4 eggs, so she uses 4 eggs.
[36m(TaskRunner pid=3147479)[0m Therefore, she uses a total of \( 3 + 4 = 7 \) eggs for breakfast and baking.
[36m(TaskRunner pid=3147479)[0m So, she has \( 16 - 7 = 9 \) eggs left.
[36m(TaskRunner pid=3147479)[0m She sells the remainder at the farmers' market daily for $2 per fresh duck egg.
[36m(TaskRunner pid=3147479)[0m Therefore, she makes \( 9 * $2 = $18 \) every day at the farmers' market.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m The answer is: $#### 18$
[36m(TaskRunner pid=3147479)[0m [ground_truth] 18
[36m(TaskRunner pid=3147479)[0m [score] 1.0
[36m(TaskRunner pid=3147479)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=3147479)[0m validation generation end
[36m(TaskRunner pid=3147479)[0m [prompt] system
[36m(TaskRunner pid=3147479)[0m You are a helpful assistant.
[36m(TaskRunner pid=3147479)[0m user
[36m(TaskRunner pid=3147479)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=3147479)[0m assistant
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m [response] Let's break this down step by step:
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m Step 1: Calculate the total meals they order per night
[36m(TaskRunner pid=3147479)[0m They order 2 meals per night, and each meal costs $5, so the cost for meals per night is:
[36m(TaskRunner pid=3147479)[0m \( 2 meals * $5 = $10 \)
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m Step 2: Calculate the cost of the wine per night
[36m(TaskRunner pid=3147479)[0m They also order a $5 bottle of wine per night, so the cost for wine per night is:
[36m(TaskRunner pid=3147479)[0m \( $5 \)
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m Step 3: Calculate the total cost per night
[36m(TaskRunner pid=3147479)[0m Adding the cost of meals and wine, the total cost per night is:
[36m(TaskRunner pid=3147479)[0m \( $10 + $5 = $15 \)
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m Step 4: Calculate the revenue per night
[36m(TaskRunner pid=3147479)[0m They get 6 reservations a night, so the revenue per night is:
[36m(TaskRunner pid=3147479)[0m \( 6 reservations * $15 = $90 \)
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m Step 5: Calculate the total revenue per week
[36m(TaskRunner pid=3147479)[0m They are open 2 days a week, so the total revenue per week is:
[36m(TaskRunner pid=3147479)[0m \( 2 days * $90 = $180 \)
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m So, they make $180 a week. 
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m #### 180
[36m(TaskRunner pid=3147479)[0m [ground_truth] 180
[36m(TaskRunner pid=3147479)[0m [score] 1.0
[36m(TaskRunner pid=3147479)[0m step:60 - global_seqlen/min:184423.000 - global_seqlen/max:200761.000 - global_seqlen/minmax_diff:16338.000 - global_seqlen/balanced_min:190573.000 - global_seqlen/balanced_max:190574.000 - global_seqlen/mean:190573.750 - actor/entropy_loss:0.503 - critic/vf_loss:0.046 - critic/vf_clipfrac:0.165 - critic/vpred_mean:0.944 - critic/grad_norm:11.590 - perf/mfu/critic:0.091 - critic/lr:0.000 - actor/kl_loss:0.179 - actor/kl_coef:0.001 - actor/pg_loss:0.032 - actor/pg_clipfrac:0.005 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.697 - perf/mfu/actor:0.260 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.555 - perf/cpu_memory_used_gb:52.265 - actor/lr:0.000 - val-core/openai/gsm8k/reward/mean@1:0.885 - val-aux/openai/gsm8k/reward/std@1:0.000 - val-core/openai/gsm8k/reward/best@1/mean:0.885 - val-aux/openai/gsm8k/reward/worst@1/mean:0.885 - training/global_step:60.000 - training/epoch:8.000 - critic/score/mean:0.957 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.957 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.000 - critic/advantages/max:2.242 - critic/advantages/min:-3.180 - critic/returns/mean:0.938 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.695 - critic/values/max:1.094 - critic/values/min:-0.114 - critic/vf_explained_var:-1.588 - response_length/mean:203.519 - response_length/max:1024.000 - response_length/min:54.000 - response_length/clip_ratio:0.002 - prompt_length/mean:94.253 - prompt_length/max:202.000 - prompt_length/min:53.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:28.804 - timing_s/reward:0.725 - timing_s/old_log_prob:6.813 - timing_s/ref:6.646 - timing_s/values:28.495 - timing_s/adv:0.232 - timing_s/update_critic:97.786 - timing_s/update_actor:34.255 - timing_s/testing:25.107 - timing_s/step:228.965 - timing_per_token_ms/values:0.019 - timing_per_token_ms/update_actor:0.022 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.028 - timing_per_token_ms/update_critic:0.064 - perf/total_num_tokens:1524590.000 - perf/time_per_step:228.965 - perf/throughput:832.328
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:61 - global_seqlen/min:184223.000 - global_seqlen/max:200194.000 - global_seqlen/minmax_diff:15971.000 - global_seqlen/balanced_min:193382.000 - global_seqlen/balanced_max:193383.000 - global_seqlen/mean:193382.875 - actor/entropy_loss:0.533 - critic/vf_loss:0.035 - critic/vf_clipfrac:0.162 - critic/vpred_mean:0.913 - critic/grad_norm:3.193 - perf/mfu/critic:0.092 - critic/lr:0.000 - actor/kl_loss:0.216 - actor/kl_coef:0.001 - actor/pg_loss:-0.006 - actor/pg_clipfrac:0.004 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.719 - perf/mfu/actor:0.263 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.555 - perf/cpu_memory_used_gb:52.426 - actor/lr:0.000 - training/global_step:61.000 - training/epoch:8.000 - critic/score/mean:0.960 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.960 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.000 - critic/advantages/max:2.046 - critic/advantages/min:-3.092 - critic/returns/mean:0.938 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.758 - critic/values/max:1.258 - critic/values/min:-0.590 - critic/vf_explained_var:-1.749 - response_length/mean:208.815 - response_length/max:1024.000 - response_length/min:36.000 - response_length/clip_ratio:0.002 - prompt_length/mean:93.346 - prompt_length/max:228.000 - prompt_length/min:56.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.059 - timing_s/reward:0.738 - timing_s/old_log_prob:7.217 - timing_s/ref:6.801 - timing_s/values:27.499 - timing_s/adv:0.251 - timing_s/update_critic:98.127 - timing_s/update_actor:34.430 - timing_s/step:201.262 - timing_per_token_ms/values:0.018 - timing_per_token_ms/update_actor:0.022 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.024 - timing_per_token_ms/update_critic:0.063 - perf/total_num_tokens:1547063.000 - perf/time_per_step:201.262 - perf/throughput:960.851
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:62 - global_seqlen/min:188444.000 - global_seqlen/max:201297.000 - global_seqlen/minmax_diff:12853.000 - global_seqlen/balanced_min:195285.000 - global_seqlen/balanced_max:195286.000 - global_seqlen/mean:195285.375 - actor/entropy_loss:0.562 - critic/vf_loss:0.044 - critic/vf_clipfrac:0.160 - critic/vpred_mean:0.924 - critic/grad_norm:14.031 - perf/mfu/critic:0.090 - critic/lr:0.000 - actor/kl_loss:0.199 - actor/kl_coef:0.001 - actor/pg_loss:-0.025 - actor/pg_clipfrac:0.004 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.805 - perf/mfu/actor:0.267 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.555 - perf/cpu_memory_used_gb:52.358 - actor/lr:0.000 - training/global_step:62.000 - training/epoch:8.000 - critic/score/mean:0.961 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.961 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.000 - critic/advantages/max:2.084 - critic/advantages/min:-3.244 - critic/returns/mean:0.941 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.777 - critic/values/max:1.430 - critic/values/min:0.000 - critic/vf_explained_var:-1.907 - response_length/mean:211.786 - response_length/max:1024.000 - response_length/min:51.000 - response_length/clip_ratio:0.002 - prompt_length/mean:93.348 - prompt_length/max:181.000 - prompt_length/min:54.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:29.222 - timing_s/reward:0.743 - timing_s/old_log_prob:6.986 - timing_s/ref:6.808 - timing_s/values:27.338 - timing_s/adv:0.232 - timing_s/update_critic:101.243 - timing_s/update_actor:34.148 - timing_s/step:206.809 - timing_per_token_ms/values:0.017 - timing_per_token_ms/update_actor:0.022 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.027 - timing_per_token_ms/update_critic:0.065 - perf/total_num_tokens:1562283.000 - perf/time_per_step:206.809 - perf/throughput:944.279
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:63 - global_seqlen/min:180238.000 - global_seqlen/max:201390.000 - global_seqlen/minmax_diff:21152.000 - global_seqlen/balanced_min:195157.000 - global_seqlen/balanced_max:195158.000 - global_seqlen/mean:195157.375 - actor/entropy_loss:0.557 - critic/vf_loss:0.048 - critic/vf_clipfrac:0.156 - critic/vpred_mean:0.908 - critic/grad_norm:14.213 - perf/mfu/critic:0.093 - critic/lr:0.000 - actor/kl_loss:0.201 - actor/kl_coef:0.001 - actor/pg_loss:0.028 - actor/pg_clipfrac:0.005 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.762 - perf/mfu/actor:0.247 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.555 - perf/cpu_memory_used_gb:52.362 - actor/lr:0.000 - training/global_step:63.000 - training/epoch:8.000 - critic/score/mean:0.956 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.956 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.000 - critic/advantages/max:2.534 - critic/advantages/min:-4.900 - critic/returns/mean:0.941 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.730 - critic/values/max:2.750 - critic/values/min:-0.344 - critic/vf_explained_var:-1.864 - response_length/mean:212.054 - response_length/max:1024.000 - response_length/min:48.000 - response_length/clip_ratio:0.000 - prompt_length/mean:92.880 - prompt_length/max:196.000 - prompt_length/min:54.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:27.349 - timing_s/reward:0.736 - timing_s/old_log_prob:7.101 - timing_s/ref:6.788 - timing_s/values:28.295 - timing_s/adv:0.251 - timing_s/update_critic:98.106 - timing_s/update_actor:36.908 - timing_s/step:205.621 - timing_per_token_ms/values:0.018 - timing_per_token_ms/update_actor:0.024 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.025 - timing_per_token_ms/update_critic:0.063 - perf/total_num_tokens:1561259.000 - perf/time_per_step:205.621 - perf/throughput:949.113
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:64 - global_seqlen/min:190444.000 - global_seqlen/max:200125.000 - global_seqlen/minmax_diff:9681.000 - global_seqlen/balanced_min:196123.000 - global_seqlen/balanced_max:196124.000 - global_seqlen/mean:196123.750 - actor/entropy_loss:0.571 - critic/vf_loss:0.046 - critic/vf_clipfrac:0.146 - critic/vpred_mean:0.878 - critic/grad_norm:13.867 - perf/mfu/critic:0.093 - critic/lr:0.000 - actor/kl_loss:0.188 - actor/kl_coef:0.001 - actor/pg_loss:0.012 - actor/pg_clipfrac:0.005 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.731 - perf/mfu/actor:0.272 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.555 - perf/cpu_memory_used_gb:53.486 - actor/lr:0.000 - training/global_step:64.000 - training/epoch:9.000 - critic/score/mean:0.958 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.958 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.000 - critic/advantages/max:2.080 - critic/advantages/min:-2.814 - critic/returns/mean:0.934 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.840 - critic/values/max:1.766 - critic/values/min:-0.182 - critic/vf_explained_var:-2.074 - response_length/mean:214.142 - response_length/max:1024.000 - response_length/min:48.000 - response_length/clip_ratio:0.003 - prompt_length/mean:92.302 - prompt_length/max:186.000 - prompt_length/min:46.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:29.523 - timing_s/reward:0.745 - timing_s/old_log_prob:7.051 - timing_s/ref:6.894 - timing_s/values:29.692 - timing_s/adv:0.404 - timing_s/update_critic:97.994 - timing_s/update_actor:33.885 - timing_s/step:206.325 - timing_per_token_ms/values:0.019 - timing_per_token_ms/update_actor:0.022 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.027 - timing_per_token_ms/update_critic:0.062 - perf/total_num_tokens:1568990.000 - perf/time_per_step:206.325 - perf/throughput:950.556
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=3147479)[0m validation generation end
[36m(TaskRunner pid=3147479)[0m [prompt] system
[36m(TaskRunner pid=3147479)[0m You are a helpful assistant.
[36m(TaskRunner pid=3147479)[0m user
[36m(TaskRunner pid=3147479)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=3147479)[0m assistant
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m [response]  Janet's ducks lay 16 eggs per day.
[36m(TaskRunner pid=3147479)[0m She eats 3 for breakfast every morning, so she uses 3 eggs.
[36m(TaskRunner pid=3147479)[0m She bakes muffins for her friends every day with 4 eggs, so she uses 4 eggs.
[36m(TaskRunner pid=3147479)[0m So, she uses $3 + 4 = 7$ eggs every day for personal use.
[36m(TaskRunner pid=3147479)[0m Therefore, she has $16 - 7 = 9$ eggs left to sell at the farmers' market every day.
[36m(TaskRunner pid=3147479)[0m She sells each egg for $2, so she makes $2 * 9 = 18$ dollars every day at the farmers' market.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m The answer is: $#### 18$
[36m(TaskRunner pid=3147479)[0m [ground_truth] 18
[36m(TaskRunner pid=3147479)[0m [score] 1.0
[36m(TaskRunner pid=3147479)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=3147479)[0m validation generation end
[36m(TaskRunner pid=3147479)[0m [prompt] system
[36m(TaskRunner pid=3147479)[0m You are a helpful assistant.
[36m(TaskRunner pid=3147479)[0m user
[36m(TaskRunner pid=3147479)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=3147479)[0m assistant
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m [response] Let's break this down step by step:
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m Step 1: Calculate the number of meals Tom's restaurant needs to prepare each night.
[36m(TaskRunner pid=3147479)[0m They order 2 meals per night, and each meal costs $5, so the cost for meals per night is:
[36m(TaskRunner pid=3147479)[0m \( 2 meals * $5 = $10 \)
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m Step 2: Calculate the cost of the wine per night.
[36m(TaskRunner pid=3147479)[0m They also order a $5 bottle of wine per night, so the cost for wine per night is:
[36m(TaskRunner pid=3147479)[0m \( $5 \)
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m Step 3: Calculate the total cost per night.
[36m(TaskRunner pid=3147479)[0m Adding the cost of meals and wine, the total cost per night is:
[36m(TaskRunner pid=3147479)[0m \( $10 + $5 = $15 \)
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m Step 4: Calculate the revenue per night.
[36m(TaskRunner pid=3147479)[0m They get 6 reservations a night, so the revenue per night is:
[36m(TaskRunner pid=3147479)[0m \( 6 reservations * $15 = $90 \)
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m Step 5: Calculate the total revenue per week.
[36m(TaskRunner pid=3147479)[0m They are open 2 days a week, so the total revenue per week is:
[36m(TaskRunner pid=3147479)[0m \( 2 days * $90 = $180 \)
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m So, Tom's restaurant makes $180 a week. 
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m #### 180
[36m(TaskRunner pid=3147479)[0m [ground_truth] 180
[36m(TaskRunner pid=3147479)[0m [score] 1.0
[36m(TaskRunner pid=3147479)[0m step:65 - global_seqlen/min:191397.000 - global_seqlen/max:207079.000 - global_seqlen/minmax_diff:15682.000 - global_seqlen/balanced_min:197683.000 - global_seqlen/balanced_max:197684.000 - global_seqlen/mean:197683.125 - actor/entropy_loss:0.546 - critic/vf_loss:0.036 - critic/vf_clipfrac:0.162 - critic/vpred_mean:0.954 - critic/grad_norm:12.347 - perf/mfu/critic:0.094 - critic/lr:0.000 - actor/kl_loss:0.192 - actor/kl_coef:0.001 - actor/pg_loss:0.011 - actor/pg_clipfrac:0.004 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.685 - perf/mfu/actor:0.268 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.555 - perf/cpu_memory_used_gb:53.480 - actor/lr:0.000 - val-core/openai/gsm8k/reward/mean@1:0.892 - val-aux/openai/gsm8k/reward/std@1:0.000 - val-core/openai/gsm8k/reward/best@1/mean:0.892 - val-aux/openai/gsm8k/reward/worst@1/mean:0.892 - training/global_step:65.000 - training/epoch:9.000 - critic/score/mean:0.968 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.968 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:1.995 - critic/advantages/min:-3.497 - critic/returns/mean:0.953 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.621 - critic/values/max:1.336 - critic/values/min:-0.379 - critic/vf_explained_var:-1.573 - response_length/mean:215.935 - response_length/max:1024.000 - response_length/min:53.000 - response_length/clip_ratio:0.001 - prompt_length/mean:92.945 - prompt_length/max:207.000 - prompt_length/min:56.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:27.250 - timing_s/reward:0.770 - timing_s/old_log_prob:7.246 - timing_s/ref:6.908 - timing_s/values:27.752 - timing_s/adv:0.235 - timing_s/update_critic:98.203 - timing_s/update_actor:34.476 - timing_s/testing:25.142 - timing_s/step:228.142 - timing_per_token_ms/values:0.018 - timing_per_token_ms/update_actor:0.022 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.025 - timing_per_token_ms/update_critic:0.062 - perf/total_num_tokens:1581465.000 - perf/time_per_step:228.142 - perf/throughput:866.493
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:66 - global_seqlen/min:196704.000 - global_seqlen/max:204519.000 - global_seqlen/minmax_diff:7815.000 - global_seqlen/balanced_min:201483.000 - global_seqlen/balanced_max:201484.000 - global_seqlen/mean:201483.875 - actor/entropy_loss:0.525 - critic/vf_loss:0.046 - critic/vf_clipfrac:0.162 - critic/vpred_mean:0.947 - critic/grad_norm:17.776 - perf/mfu/critic:0.094 - critic/lr:0.000 - actor/kl_loss:0.175 - actor/kl_coef:0.001 - actor/pg_loss:-0.009 - actor/pg_clipfrac:0.005 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.697 - perf/mfu/actor:0.279 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.555 - perf/cpu_memory_used_gb:53.536 - actor/lr:0.000 - training/global_step:66.000 - training/epoch:9.000 - critic/score/mean:0.960 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.960 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:2.465 - critic/advantages/min:-5.771 - critic/returns/mean:0.939 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.766 - critic/values/max:3.125 - critic/values/min:-1.156 - critic/vf_explained_var:-1.760 - response_length/mean:220.045 - response_length/max:1024.000 - response_length/min:60.000 - response_length/clip_ratio:0.002 - prompt_length/mean:94.773 - prompt_length/max:205.000 - prompt_length/min:52.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.165 - timing_s/reward:0.761 - timing_s/old_log_prob:7.263 - timing_s/ref:8.087 - timing_s/values:27.628 - timing_s/adv:0.244 - timing_s/update_critic:99.900 - timing_s/update_actor:33.706 - timing_s/step:203.879 - timing_per_token_ms/values:0.017 - timing_per_token_ms/update_actor:0.021 - timing_per_token_ms/ref:0.005 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.023 - timing_per_token_ms/update_critic:0.062 - perf/total_num_tokens:1611871.000 - perf/time_per_step:203.879 - perf/throughput:988.251
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:67 - global_seqlen/min:192063.000 - global_seqlen/max:204240.000 - global_seqlen/minmax_diff:12177.000 - global_seqlen/balanced_min:199365.000 - global_seqlen/balanced_max:199366.000 - global_seqlen/mean:199365.250 - actor/entropy_loss:0.552 - critic/vf_loss:0.034 - critic/vf_clipfrac:0.154 - critic/vpred_mean:0.927 - critic/grad_norm:6.453 - perf/mfu/critic:0.096 - critic/lr:0.000 - actor/kl_loss:0.213 - actor/kl_coef:0.001 - actor/pg_loss:-0.018 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.751 - perf/mfu/actor:0.275 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.555 - perf/cpu_memory_used_gb:53.483 - actor/lr:0.000 - training/global_step:67.000 - training/epoch:9.000 - critic/score/mean:0.962 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.962 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:2.161 - critic/advantages/min:-2.965 - critic/returns/mean:0.946 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.902 - critic/values/max:1.289 - critic/values/min:-0.241 - critic/vf_explained_var:-2.831 - response_length/mean:217.540 - response_length/max:1024.000 - response_length/min:35.000 - response_length/clip_ratio:0.000 - prompt_length/mean:93.968 - prompt_length/max:206.000 - prompt_length/min:55.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:27.534 - timing_s/reward:0.748 - timing_s/old_log_prob:7.035 - timing_s/ref:6.886 - timing_s/values:28.481 - timing_s/adv:0.215 - timing_s/update_critic:97.102 - timing_s/update_actor:33.855 - timing_s/step:201.953 - timing_per_token_ms/values:0.018 - timing_per_token_ms/update_actor:0.021 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.025 - timing_per_token_ms/update_critic:0.061 - perf/total_num_tokens:1594922.000 - perf/time_per_step:201.953 - perf/throughput:987.186
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:68 - global_seqlen/min:191913.000 - global_seqlen/max:208677.000 - global_seqlen/minmax_diff:16764.000 - global_seqlen/balanced_min:203595.000 - global_seqlen/balanced_max:203596.000 - global_seqlen/mean:203595.375 - actor/entropy_loss:0.607 - critic/vf_loss:0.044 - critic/vf_clipfrac:0.163 - critic/vpred_mean:0.920 - critic/grad_norm:14.093 - perf/mfu/critic:0.096 - critic/lr:0.000 - actor/kl_loss:0.223 - actor/kl_coef:0.001 - actor/pg_loss:-0.003 - actor/pg_clipfrac:0.004 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.629 - perf/mfu/actor:0.274 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.555 - perf/cpu_memory_used_gb:53.707 - actor/lr:0.000 - training/global_step:68.000 - training/epoch:9.000 - critic/score/mean:0.957 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.957 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:2.049 - critic/advantages/min:-3.142 - critic/returns/mean:0.944 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.746 - critic/values/max:1.180 - critic/values/min:-0.363 - critic/vf_explained_var:-1.889 - response_length/mean:223.875 - response_length/max:1024.000 - response_length/min:52.000 - response_length/clip_ratio:0.000 - prompt_length/mean:94.243 - prompt_length/max:246.000 - prompt_length/min:55.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:25.374 - timing_s/reward:0.751 - timing_s/old_log_prob:7.268 - timing_s/ref:6.993 - timing_s/values:27.463 - timing_s/adv:0.228 - timing_s/update_critic:99.076 - timing_s/update_actor:34.712 - timing_s/step:201.960 - timing_per_token_ms/values:0.017 - timing_per_token_ms/update_actor:0.021 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.022 - timing_per_token_ms/update_critic:0.061 - perf/total_num_tokens:1628763.000 - perf/time_per_step:201.960 - perf/throughput:1008.098
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m step:69 - global_seqlen/min:197767.000 - global_seqlen/max:215441.000 - global_seqlen/minmax_diff:17674.000 - global_seqlen/balanced_min:206733.000 - global_seqlen/balanced_max:206734.000 - global_seqlen/mean:206733.500 - actor/entropy_loss:0.609 - critic/vf_loss:0.042 - critic/vf_clipfrac:0.150 - critic/vpred_mean:0.902 - critic/grad_norm:14.956 - perf/mfu/critic:0.096 - critic/lr:0.000 - actor/kl_loss:0.201 - actor/kl_coef:0.001 - actor/pg_loss:0.024 - actor/pg_clipfrac:0.004 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.712 - perf/mfu/actor:0.278 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.555 - perf/cpu_memory_used_gb:53.765 - actor/lr:0.000 - training/global_step:69.000 - training/epoch:9.000 - critic/score/mean:0.963 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.963 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:2.099 - critic/advantages/min:-4.674 - critic/returns/mean:0.950 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.836 - critic/values/max:2.859 - critic/values/min:-0.015 - critic/vf_explained_var:-2.755 - response_length/mean:228.337 - response_length/max:1024.000 - response_length/min:47.000 - response_length/clip_ratio:0.001 - prompt_length/mean:94.684 - prompt_length/max:212.000 - prompt_length/min:54.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.762 - timing_s/reward:0.774 - timing_s/old_log_prob:7.421 - timing_s/ref:7.126 - timing_s/values:27.829 - timing_s/adv:0.212 - timing_s/update_critic:100.658 - timing_s/update_actor:34.750 - timing_s/step:205.640 - timing_per_token_ms/values:0.017 - timing_per_token_ms/update_actor:0.021 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.023 - timing_per_token_ms/update_critic:0.061 - perf/total_num_tokens:1653868.000 - perf/time_per_step:205.640 - perf/throughput:1005.315
[36m(TaskRunner pid=3147479)[0m list(reward_extra_infos_dict.keys())=[]
[36m(TaskRunner pid=3147479)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=3147479)[0m validation generation end
[36m(TaskRunner pid=3147479)[0m [prompt] system
[36m(TaskRunner pid=3147479)[0m You are a helpful assistant.
[36m(TaskRunner pid=3147479)[0m user
[36m(TaskRunner pid=3147479)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=3147479)[0m assistant
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m [response]  Janet's ducks lay $16$ eggs per day.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m She eats $3$ for breakfast every morning, and she bakes muffins for her friends with $4$ eggs, so she uses $3 + 4 = 7$ eggs for breakfast and baking.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m Therefore, she uses $7$ eggs per day, leaving her with $16 - 7 = 9$ eggs.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m She sells the remainder at the farmers' market for $2 per fresh duck egg.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m So, she makes $9 * $2 = $18$ every day at the farmers' market.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m #### 18
[36m(TaskRunner pid=3147479)[0m [ground_truth] 18
[36m(TaskRunner pid=3147479)[0m [score] 1.0
[36m(TaskRunner pid=3147479)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=3147479)[0m validation generation end
[36m(TaskRunner pid=3147479)[0m [prompt] system
[36m(TaskRunner pid=3147479)[0m You are a helpful assistant.
[36m(TaskRunner pid=3147479)[0m user
[36m(TaskRunner pid=3147479)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=3147479)[0m assistant
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m [response] Let's break down the problem step by step:
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m Step 1: Calculate the total meals they need to prepare per night
[36m(TaskRunner pid=3147479)[0m They get 6 reservations a night, and they need to prepare 2 meals per reservation, so they need to prepare \( 6 * 2 = 12 meals \) per night.
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m Step 2: Calculate the cost of the meals per night
[36m(TaskRunner pid=3147479)[0m Each meal costs $5, so the cost of the meals per night is \( 12 * $5 = $60 \).
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m Step 3: Calculate the cost of the wine per night
[36m(TaskRunner pid=3147479)[0m They also need to order a $5 bottle of wine per night, so the cost of the wine per night is \( $5 \).
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m Step 4: Calculate the total cost per night
[36m(TaskRunner pid=3147479)[0m The total cost per night is the cost of the meals plus the cost of the wine, which is \( $60 + $5 = $65 \).
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m Step 5: Calculate the revenue per night
[36m(TaskRunner pid=3147479)[0m They are open 2 days a week, so the revenue per week is \( 2 * $65 = $130 \).
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m So, the amount they make a week is \( $130 \).
[36m(TaskRunner pid=3147479)[0m 
[36m(TaskRunner pid=3147479)[0m #### 130
[36m(TaskRunner pid=3147479)[0m [ground_truth] 180
[36m(TaskRunner pid=3147479)[0m [score] 0.0
[36m(TaskRunner pid=3147479)[0m step:70 - global_seqlen/min:201298.000 - global_seqlen/max:214381.000 - global_seqlen/minmax_diff:13083.000 - global_seqlen/balanced_min:209422.000 - global_seqlen/balanced_max:209423.000 - global_seqlen/mean:209422.250 - actor/entropy_loss:0.676 - critic/vf_loss:0.049 - critic/vf_clipfrac:0.157 - critic/vpred_mean:0.898 - critic/grad_norm:14.832 - perf/mfu/critic:0.098 - critic/lr:0.000 - actor/kl_loss:0.217 - actor/kl_coef:0.001 - actor/pg_loss:0.029 - actor/pg_clipfrac:0.005 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.793 - perf/mfu/actor:0.272 - perf/max_memory_allocated_gb:83.586 - perf/max_memory_reserved_gb:106.555 - perf/cpu_memory_used_gb:53.867 - actor/lr:0.000 - val-core/openai/gsm8k/reward/mean@1:0.881 - val-aux/openai/gsm8k/reward/std@1:0.000 - val-core/openai/gsm8k/reward/best@1/mean:0.881 - val-aux/openai/gsm8k/reward/worst@1/mean:0.881 - training/global_step:70.000 - training/epoch:9.000 - critic/score/mean:0.952 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.952 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.000 - critic/advantages/max:2.079 - critic/advantages/min:-2.791 - critic/returns/mean:0.939 - critic/returns/max:1.000 - critic/returns/min:0.000 - critic/values/mean:0.840 - critic/values/max:1.188 - critic/values/min:-0.006 - critic/vf_explained_var:-2.269 - response_length/mean:234.630 - response_length/max:1024.000 - response_length/min:61.000 - response_length/clip_ratio:0.001 - prompt_length/mean:92.592 - prompt_length/max:202.000 - prompt_length/min:53.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:31.136 - timing_s/reward:0.763 - timing_s/old_log_prob:7.736 - timing_s/ref:7.538 - timing_s/values:27.671 - timing_s/adv:0.254 - timing_s/update_critic:99.612 - timing_s/update_actor:35.961 - timing_s/testing:23.787 - timing_s/step:234.558 - timing_per_token_ms/values:0.017 - timing_per_token_ms/update_actor:0.021 - timing_per_token_ms/ref:0.004 - timing_per_token_ms/adv:0.000 - timing_per_token_ms/gen:0.026 - timing_per_token_ms/update_critic:0.059 - perf/total_num_tokens:1675378.000 - perf/time_per_step:234.558 - perf/throughput:892.839
[36m(TaskRunner pid=3147479)[0m ("Final validation metrics: {'val-core/openai/gsm8k/reward/mean@1': "
[36m(TaskRunner pid=3147479)[0m  "0.8809704321455648, 'val-aux/openai/gsm8k/reward/std@1': 0.0, "
[36m(TaskRunner pid=3147479)[0m  "'val-core/openai/gsm8k/reward/best@1/mean': 0.8809704321455648, "
[36m(TaskRunner pid=3147479)[0m  "'val-aux/openai/gsm8k/reward/worst@1/mean': 0.8809704321455648}")
